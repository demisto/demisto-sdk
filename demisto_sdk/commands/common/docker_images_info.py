import functools
from typing import Dict, Optional

from pydantic import BaseModel

from demisto_sdk.commands.common.logger import logger
from demisto_sdk.commands.common.singleton import Singleton


class DockerImageTagMetadata(BaseModel):
    python_version: Optional[str]


class DockerImagesInfo(Singleton, BaseModel):
    docker_images: Dict[str, Dict[str, DockerImageTagMetadata]]

    def __init__(self, url: str = "https:dockerfiles-info..."):
        # response = requests.get(url)
        a = {
            "docker_images": {
                "python3": {
                    "3.10.12.63474": {"python_version": "3.10.12"},
                    "3.9.5.21272": {"python_version": "3.9.5"},
                    "3.10.12.66339": {"python_version": "3.10.12"},
                    "3.10.10.48392": {"python_version": "3.10.10"},
                    "3.10.12.65389": {"python_version": "3.10.12"},
                    "3.9.8.24399": {"python_version": "3.9.8"},
                    "3.10.1.25933": {"python_version": "3.10.1"},
                    "3.10.10.49934": {"python_version": "3.10.10"},
                    "3.10.5.31928": {"python_version": ""},
                    "3.8.5.10845": {"python_version": "3.8.5"},
                    "3.10.8.37753": {"python_version": "3.10.8"},
                    "3.10.9.42476": {"python_version": "3.10.9"},
                    "3.10.1.26972": {"python_version": "3.10.1"},
                    "3.10.10.51930": {"python_version": "3.10.10"},
                    "3.10.7.33922": {"python_version": ""},
                    "3.10.11.56082": {"python_version": "3.10.11"},
                    "3.10.5.31797": {"python_version": ""},
                    "3.10.7.35188": {"python_version": ""},
                    "3.8.2.6981": {"python_version": "3.8.2"},
                    "3.8.3.8715": {"python_version": "3.8.3"},
                    "3.9.7.24076": {"python_version": "3.9.7"},
                    "3.10.6.33415": {"python_version": ""},
                    "3.10.11.58677": {"python_version": "3.10.11"},
                    "3.8.6.13358": {"python_version": "3.8.6"},
                    "3.10.9.45313": {"python_version": "3.10.9"},
                    "3.10.8.36650": {"python_version": "3.10.8"},
                    "3.10.4.27798": {"python_version": "3.10.4"},
                    "3.10.11.61265": {"python_version": "3.10.11"},
                    "3.10.9.40422": {"python_version": "3.10.9"},
                    "3.10.4.30607": {"python_version": "3.10.4"},
                    "3.10.4.29342": {"python_version": "3.10.4"},
                    "3.10.9.46032": {"python_version": "3.10.9"},
                    "3.10.9.46807": {"python_version": "3.10.9"},
                    "3.9.9.25564": {"python_version": "3.9.9"},
                    "3.9.5.20070": {"python_version": "3.9.5"},
                    "3.10.9.44472": {"python_version": "3.10.9"},
                    "3.8.3.9324": {"python_version": "3.8.3"},
                    "3.10.8.37233": {"python_version": "3.10.8"},
                    "3.10.12.62631": {"python_version": "3.10.12"},
                    "3.10.10.47713": {"python_version": "3.10.10"},
                    "3.7.4.1150": {"python_version": ""},
                    "3.10.11.54132": {"python_version": "3.10.11"},
                    "3.8.6.12176": {"python_version": "3.8.6"},
                    "3.10.1.27636": {"python_version": ""},
                    "3.9.1.14969": {"python_version": "3.9.1"},
                    "3.7.4.977": {"python_version": ""},
                    "3.10.8.35482": {"python_version": ""},
                    "3.7.4.2245": {"python_version": "3.7.4"},
                },
                "crypto": {
                    "1.0.0.66562": {"python_version": "3.10.12"},
                    "1.0.0.63672": {"python_version": "3.10.12"},
                    "1.0.0.51288": {"python_version": "3.10.10"},
                    "1.0.0.11287": {"python_version": "3.8.5"},
                    "1.0.0.61689": {"python_version": "3.10.11"},
                    "1.0.0.58095": {"python_version": "3.10.11"},
                    "1.0.0.65874": {"python_version": "3.10.12"},
                    "1.0.0.52480": {"python_version": "3.10.10"},
                },
                "pyjwt3": {
                    "1.0.0.48806": {"python_version": "3.10.10"},
                    "1.0.0.63826": {"python_version": "3.10.12"},
                    "1.0.0.65237": {"python_version": "3.10.12"},
                    "1.0.0.23674": {"python_version": "3.9.6"},
                    "1.0.0.66845": {"python_version": "3.10.12"},
                    "1.0.0.13142": {"python_version": "3.8.6"},
                    "1.0.0.27257": {"python_version": "3.9.7"},
                    "1.0.0.55864": {"python_version": "3.10.11"},
                    "1.0.0.49643": {"python_version": "3.10.10"},
                },
                "pytan": {"1.0.0.38590": {"python_version": "2.7.18"}},
                "python_pancloud_v2": {"1.0.0.64955": {"python_version": "3.10.11"}},
                "py3-tools": {
                    "1.0.0.49475": {"python_version": "3.10.10"},
                    "1.0.0.67011": {"python_version": "3.10.12"},
                    "1.0.0.65178": {"python_version": "3.10.12"},
                    "0.0.1.25751": {"python_version": "3.9.9"},
                    "1.0.0.49572": {"python_version": "3.10.10"},
                    "1.0.0.31193": {"python_version": "3.10.4"},
                    "1.0.0.65317": {"python_version": "3.10.12"},
                    "1.0.0.56465": {"python_version": "3.10.11"},
                    "1.0.0.47433": {"python_version": "3.10.9"},
                    "1.0.0.44868": {"python_version": "3.10.9"},
                    "1.0.0.63856": {"python_version": "3.10.12"},
                    "1.0.0.66127": {"python_version": "3.10.12"},
                    "1.0.0.49703": {"python_version": "3.10.10"},
                    "1.0.0.45685": {"python_version": "3.10.9"},
                    "1.0.0.64131": {"python_version": "3.10.12"},
                    "1.0.0.66062": {"python_version": "3.10.12"},
                    "1.0.0.45904": {"python_version": "3.10.9"},
                    "1.0.0.47376": {"python_version": "3.10.9"},
                    "1.0.0.43697": {"python_version": "3.10.9"},
                    "1.0.0.49159": {"python_version": "3.10.10"},
                    "1.0.0.66616": {"python_version": "3.10.12"},
                    "0.0.1.30715": {"python_version": "3.10.4"},
                    "1.0.0.61931": {"python_version": "3.10.11"},
                    "1.0.0.49929": {"python_version": "3.10.10"},
                    "1.0.0.38394": {"python_version": "3.10.8"},
                    "1.0.0.45198": {"python_version": "3.10.9"},
                    "1.0.0.67089": {"python_version": "3.10.12"},
                    "1.0.0.50499": {"python_version": "3.10.10"},
                    "1.0.0.58222": {"python_version": "3.10.11"},
                    "1.0.0.46591": {"python_version": "3.10.9"},
                },
                "taxii2": {
                    "1.0.0.18446": {"python_version": "3.9.2"},
                    "1.0.0.66032": {"python_version": "3.10.12"},
                    "1.0.0.61540": {"python_version": "3.10.11"},
                    "1.0.0.63768": {"python_version": "3.10.12"},
                    "1.0.0.23423": {"python_version": "3.9.6"},
                    "1.0.0.57584": {"python_version": "3.10.11"},
                },
                "google-api-py3": {
                    "1.0.0.64100": {"python_version": "3.10.12"},
                    "1.0.0.65791": {"python_version": "3.10.12"},
                    "1.0.0.55175": {"python_version": "3.10.11"},
                    "1.0.0.64930": {"python_version": "3.10.12"},
                },
                "glpi": {"1.0.0.65890": {"python_version": "3.10.12"}},
                "fastapi": {
                    "1.0.0.36992": {"python_version": "3.10.8"},
                    "1.0.0.64153": {"python_version": "3.10.12"},
                    "1.0.0.27446": {"python_version": "3.9.6"},
                    "1.0.0.61475": {"python_version": "3.10.11"},
                    "1.0.0.63688": {"python_version": "3.10.12"},
                    "1.0.0.64474": {"python_version": "3.10.12"},
                    "1.0.0.56647": {"python_version": "3.10.11"},
                    "1.0.0.65888": {"python_version": "3.10.12"},
                    "1.0.0.32142": {"python_version": ""},
                    "1.0.0.28667": {"python_version": "3.9.6"},
                },
                "boto3py3": {
                    "1.0.0.65194": {"python_version": "3.10.12"},
                    "1.0.0.38849": {"python_version": "3.10.8"},
                    "1.0.0.52713": {"python_version": "3.10.10"},
                    "1.0.0.45936": {"python_version": "3.10.9"},
                    "1.0.0.66174": {"python_version": "3.10.12"},
                    "1.0.0.41082": {"python_version": "3.10.9"},
                    "1.0.0.63019": {"python_version": "3.10.12"},
                    "1.0.0.63655": {"python_version": ""},
                    "1.0.0.64480": {"python_version": "3.10.12"},
                    "1.0.0.41926": {"python_version": "3.10.9"},
                    "1.0.0.48955": {"python_version": "3.10.10"},
                    "1.0.0.64969": {"python_version": "3.10.12"},
                    "1.0.0.67091": {"python_version": "3.10.12"},
                    "1.0.0.33827": {"python_version": ""},
                },
                "lxml": {"1.0.0.63707": {"python_version": "3.10.12"}},
                "python": {
                    "2.7.18.20958": {"python_version": "2.7.18"},
                    "2.7.18.24066": {"python_version": "2.7.18"},
                    "2.7.18.27799": {"python_version": "2.7.18"},
                    "2.7.18.24398": {"python_version": "2.7.18"},
                    "2.7.18.8715": {"python_version": "2.7.18"},
                    "2.7.18.52566": {"python_version": "2.7.18"},
                    "2.7.18.10627": {"python_version": "2.7.18"},
                    "2.7.18.63476": {"python_version": "2.7.18"},
                    "2.7.18.9326": {"python_version": "2.7.18"},
                },
                "polyswarm": {"1.0.0.18926": {"python_version": "3.9.4"}},
                "pymisp2": {"1.0.0.63745": {"python_version": "3.10.12"}},
                "pymisp": {"1.0.0.19190": {"python_version": "3.9.4"}},
                "fp-smc": {"1.0.22.66577": {"python_version": "3.10.12"}},
                "tweepy": {"1.0.0.23810": {"python_version": "3.9.6"}},
                "netutils": {
                    "1.0.0.24101": {"python_version": "3.9.7"},
                    "1.0.0.46652": {"python_version": "3.10.9"},
                    "1.0.0.43061": {"python_version": "3.10.9"},
                },
                "chromium": {"1.0.0.56296": {"python_version": "3.10.11"}},
                "py42": {"1.0.0.66909": {"python_version": "3.10.12"}},
                "ansible-runner": {
                    "1.0.0.24037": {"python_version": "3.9.6"},
                    "1.0.0.21184": {"python_version": "3.9.5"},
                    "1.0.0.21453": {"python_version": "3.9.5"},
                    "1.0.0.47562": {"python_version": "3.10.9"},
                    "1.0.0.20884": {"python_version": "3.9.5"},
                },
                "python_pancloud": {
                    "1.0.0.66801": {"python_version": "3.10.11"},
                    "1.0.0.7740": {"python_version": "3.7.5"},
                },
                "akamai": {
                    "1.0.0.63810": {"python_version": "3.10.12"},
                    "1.0.0.65229": {"python_version": "3.10.12"},
                    "1.0.0.34769": {"python_version": "3.10.4"},
                },
                "btfl-soup": {
                    "1.0.1.45563": {"python_version": "3.10.9"},
                    "1.0.1.46582": {"python_version": "3.10.9"},
                    "1.0.1.63668": {"python_version": "3.10.12"},
                    "1.0.0.925": {"python_version": ""},
                    "1.0.1.20315": {"python_version": "3.9.4"},
                    "1.0.1.6233": {"python_version": "3.7.5"},
                },
                "hashicorp": {"1.0.0.65633": {"python_version": "3.10.12"}},
                "blueliv": {"1.0.0.52588": {"python_version": "2.7.18"}},
                "taxii": {
                    "1.0.0.45815": {"python_version": "3.10.9"},
                    "1.0.0.43208": {"python_version": "3.10.9"},
                    "1.0.0.48109": {"python_version": "3.10.10"},
                },
                "syslog": {
                    "1.0.0.61542": {"python_version": "3.10.11"},
                    "1.0.0.48738": {"python_version": "3.10.10"},
                },
                "pydantic-jwt3": {
                    "1.0.0.64406": {"python_version": "3.10.12"},
                    "1.0.0.63835": {"python_version": "3.10.12"},
                    "1.0.0.45851": {"python_version": "3.10.9"},
                },
                "devo": {"1.0.0.66471": {"python_version": "3.10.12"}},
                "threatconnect-sdk": {"1.0.0.7659": {"python_version": "2.7.17"}},
                "threatconnect-py3-sdk": {"1.0.0.40378": {"python_version": "3.9.9"}},
                "google-cloud-storage": {
                    "1.0.0.25839": {"python_version": "3.9.6"},
                    "1.0.0.63865": {"python_version": "3.10.12"},
                },
                "google-cloud-translate": {
                    "1.0.0.63615": {"python_version": "3.10.12"}
                },
                "pycountry": {
                    "1.0.0.65943": {"python_version": "3.10.12"},
                    "1.0.0.63741": {"python_version": "3.10.12"},
                    "1.0.0.36195": {"python_version": "3.10.8"},
                },
                "bottle": {
                    "1.0.0.32745": {"python_version": ""},
                    "1.0.0.65861": {"python_version": "3.10.12"},
                },
                "googleapi-python3": {
                    "1.0.0.65068": {"python_version": "3.10.12"},
                    "1.0.0.66918": {"python_version": ""},
                    "1.0.0.63869": {"python_version": "3.10.12"},
                    "1.0.0.65453": {"python_version": "3.10.12"},
                    "1.0.0.67173": {"python_version": "3.10.12"},
                    "1.0.0.62073": {"python_version": "3.10.11"},
                    "1.0.0.40612": {"python_version": "3.10.9"},
                    "1.0.0.64742": {"python_version": "3.10.12"},
                    "1.0.0.62767": {"python_version": "3.10.12"},
                    "1.0.0.64222": {"python_version": "3.10.12"},
                    "1.0.0.12698": {"python_version": "3.8.6"},
                },
                "ntlm": {
                    "1.0.0.44693": {"python_version": "3.10.9"},
                    "1.0.0.64630": {"python_version": "3.10.12"},
                    "1.0.0.31381": {"python_version": "3.10.4"},
                },
                "winrm": {"1.0.0.13142": {"python_version": "3.8.6"}},
                "teams": {
                    "1.0.0.14902": {"python_version": "3.8.6"},
                    "1.0.0.66853": {"python_version": "3.10.12"},
                    "1.0.0.43500": {"python_version": "3.10.9"},
                },
                "powershell-ubuntu": {
                    "7.2.2.29705": {"python_version": ""},
                    "7.1.4.24032": {"python_version": ""},
                    "7.3.0.49844": {"python_version": ""},
                    "7.1.3.22304": {"python_version": ""},
                },
                "taxii-server": {
                    "1.0.0.66858": {"python_version": "3.10.12"},
                    "1.0.0.32901": {"python_version": ""},
                },
                "pyotrs": {"1.0.0.44880": {"python_version": "3.10.9"}},
                "pwsh-exchangev3": {
                    "1.0.0.49863": {"python_version": ""},
                    "1.0.0.67228": {"python_version": ""},
                },
                "xml-feed": {
                    "1.0.0.63829": {"python_version": "3.10.12"},
                    "1.0.0.29458": {"python_version": "3.10.4"},
                    "1.0.0.65027": {"python_version": "3.10.12"},
                },
                "datadog-api-client": {"1.0.0.65877": {"python_version": "3.10.12"}},
                "netmiko": {
                    "1.0.0.65282": {"python_version": "3.10.12"},
                    "1.0.0.65807": {"python_version": "3.10.12"},
                    "1.0.0.62777": {"python_version": "3.10.12"},
                    "1.0.0.61830": {"python_version": "3.10.11"},
                },
                "cloudshare": {"1.0.0.14120": {"python_version": "3.8.6"}},
                "rubrik-polaris-sdk-py3": {
                    "1.0.0.66039": {"python_version": "3.10.12"}
                },
                "py3ews": {
                    "1.0.0.66850": {"python_version": "3.10.12"},
                    "1.0.0.47270": {"python_version": "3.10.9"},
                },
                "feed-parser": {"1.0.0.14495": {"python_version": "3.8.6"}},
                "opencti-v4": {
                    "1.0.0.46493": {"python_version": "3.10.9"},
                    "1.0.0.61509": {"python_version": "3.10.11"},
                },
                "opencti": {"1.0.0.41469": {"python_version": "3.10.9"}},
                "reversinglabs-sdk-py3": {
                    "2.0.0.64132": {"python_version": "3.10.12"},
                    "2.0.0.40822": {"python_version": "3.10.9"},
                },
                "pan-os-python": {"1.0.0.65924": {"python_version": "3.10.12"}},
                "accessdata": {"1.1.0.33872": {"python_version": "3.9.8"}},
                "dxl": {
                    "1.0.0.63890": {"python_version": "3.9.17"},
                    "1.0.0.35274": {"python_version": "3.9.9"},
                    "1.0.0.65407": {"python_version": "3.9.17"},
                },
                "splunksdk": {"1.0.0.49073": {"python_version": "2.7.18"}},
                "paho-mqtt": {"1.0.0.19143": {"python_version": "3.9.4"}},
                "jmespath": {"1.0.0.23980": {"python_version": "3.9.6"}},
                "py-ews": {"5.0.2.63879": {"python_version": "3.10.11"}},
                "cymruwhois": {"1.0.0.65875": {"python_version": "3.10.12"}},
                "snowflake": {"1.0.0.2505": {"python_version": "3.7.4"}},
                "argus-toolbelt": {"2.0.0.29288": {"python_version": "3.9.6"}},
                "ippysocks-py3": {"1.0.0.63627": {"python_version": "3.10.12"}},
                "yolo-coco": {"1.0.0.15530": {"python_version": "3.9.1"}},
                "dnstwist": {"1.0.0.46433": {"python_version": "3.10.9"}},
                "zeep": {"1.0.0.23423": {"python_version": "3.9.6"}},
                "python3-deb": {
                    "3.9.1.15758": {"python_version": "3.9.1"},
                    "3.10.12.63475": {"python_version": "3.10.12"},
                    "3.10.10.49238": {"python_version": "3.10.10"},
                },
                "carbon-black-cloud": {"1.0.0.64437": {"python_version": "3.10.12"}},
                "octoxlabs": {"1.0.0.65919": {"python_version": "3.10.12"}},
                "illumio": {"1.0.0.65903": {"python_version": "3.10.12"}},
                "oauthlib": {
                    "1.0.0.38743": {"python_version": "3.10.8"},
                    "1.0.0.63821": {"python_version": "3.10.12"},
                },
                "xsoar-tools": {
                    "1.0.0.25075": {"python_version": "3.9.6"},
                    "1.0.0.36076": {"python_version": "3.10.8"},
                    "1.0.0.42327": {"python_version": "3.10.9"},
                    "1.0.0.62936": {"python_version": "3.10.12"},
                    "1.0.0.32653": {"python_version": ""},
                    "1.0.0.40869": {"python_version": "3.10.9"},
                    "1.0.0.19258": {"python_version": "3.9.4"},
                    "1.0.0.46482": {"python_version": "3.10.9"},
                    "1.0.0.58259": {"python_version": "3.10.11"},
                },
                "oci": {"1.0.0.65918": {"python_version": "3.10.12"}},
                "bigquery": {"1.0.0.61798": {"python_version": "3.10.11"}},
                "graphql": {
                    "1.0.0.65897": {"python_version": "3.10.12"},
                    "1.0.0.45620": {"python_version": "3.10.9"},
                },
                "flask-nginx": {
                    "1.0.0.65013": {"python_version": "3.10.12"},
                    "1.0.0.63817": {"python_version": "3.10.12"},
                    "1.0.0.23674": {"python_version": "3.9.6"},
                    "1.0.0.20328": {"python_version": "3.9.1"},
                },
                "tidy": {"1.0.0.62989": {"python_version": "3.10.12"}},
                "minio": {"1.0.0.19143": {"python_version": "3.9.4"}},
                "m2crypto": {"1.0.0.65914": {"python_version": "3.10.12"}},
                "resilient": {"2.0.0.45701": {"python_version": "3.10.9"}},
                "duoadmin3": {"1.0.0.65621": {"python_version": "3.10.12"}},
                "joe-security": {"1.0.0.46413": {"python_version": "3.10.9"}},
                "pykafka": {"1.0.0.19034": {"python_version": "2.7.18"}},
                "confluent-kafka": {"1.0.0.65871": {"python_version": "3.10.12"}},
                "bs4-py3": {
                    "1.0.0.48637": {"python_version": "3.10.10"},
                    "1.0.0.32198": {"python_version": ""},
                    "1.0.0.30051": {"python_version": "3.10.4"},
                    "1.0.0.24176": {"python_version": "3.9.7"},
                    "1.0.0.63660": {"python_version": "3.10.12"},
                },
                "openssh": {"1.0.0.12410": {"python_version": "3.8.6"}},
                "google-k8s-engine": {"1.0.0.64696": {"python_version": ""}},
                "keeper-ksm": {"1.0.0.67054": {"python_version": "3.10.12"}},
                "greynoise": {
                    "1.0.0.65909": {"python_version": "3.10.12"},
                    "1.0.0.61972": {"python_version": "3.10.11"},
                },
                "exodusintelligence": {"1.0.0.34185": {"python_version": ""}},
                "bs4": {
                    "1.0.0.8854": {"python_version": "2.7.18"},
                    "1.0.0.24033": {"python_version": "2.7.18"},
                },
                "smbprotocol": {"1.0.0.63639": {"python_version": "3.10.12"}},
                "smb": {"1.0.0.7685": {"python_version": "2.7.17"}},
                "google-vision-api": {"1.0.0.63870": {"python_version": "3.10.12"}},
                "uptycs": {"1.0.0.63766": {"python_version": "3.10.12"}},
                "google-kms": {"1.0.0.62005": {"python_version": "3.10.11"}},
                "slackv3": {"1.0.0.63762": {"python_version": "3.10.12"}},
                "slack": {"1.0.0.42956": {"python_version": "3.10.9"}},
                "sixgill": {
                    "1.0.0.20925": {"python_version": "3.9.4"},
                    "1.0.0.66910": {"python_version": "3.10.12"},
                    "1.0.0.50510": {"python_version": "3.10.10"},
                    "1.0.0.23434": {"python_version": "3.9.6"},
                    "1.0.0.28665": {"python_version": "3.9.6"},
                },
                "ibm-db2": {"1.0.0.27972": {"python_version": "3.10.4"}},
                "armorblox": {"1.0.0.65856": {"python_version": "3.10.12"}},
                "lacework": {"1.0.0.47313": {"python_version": "3.10.9"}},
                "genericsql": {"1.1.0.62758": {"python_version": "3.10.12"}},
                "pycef": {"1.0.0.61516": {"python_version": "3.10.11"}},
                "pwsh-infocyte": {"1.1.0.23036": {"python_version": ""}},
                "axonius": {"1.0.0.40908": {"python_version": "3.10.9"}},
                "cloaken": {"1.0.0.44754": {"python_version": "3.10.9"}},
                "nmap": {"1.0.0.46402": {"python_version": "3.10.9"}},
                "splunksdk-py3": {"1.0.0.66897": {"python_version": "3.10.12"}},
                "tesseract": {"1.0.0.62842": {"python_version": "3.10.12"}},
                "opnsense": {"1.0.0.65922": {"python_version": "3.10.12"}},
                "luminate": {"1.0.0.14061": {"python_version": "2.7.18"}},
                "faker3": {
                    "1.0.0.17991": {"python_version": "3.7.5"},
                    "1.0.0.247": {"python_version": ""},
                },
                "azure-kusto-data": {"1.0.0.66840": {"python_version": "3.10.12"}},
                "trustar": {
                    "20.2.0.65839": {"python_version": "3.10.12"},
                    "20.1.0.8039": {"python_version": "3.8.2"},
                },
                "boto3": {"2.0.0.52592": {"python_version": "2.7.18"}},
                "feed-performance-test": {"1.0.46565": {"python_version": "3.9.6"}},
                "dnspython": {
                    "1.0.0.24037": {"python_version": "3.9.6"},
                    "1.0.0.12410": {"python_version": "3.8.6"},
                },
                "dxl2": {"1.0.0.38570": {"python_version": "2.7.18"}},
                "gdetect": {"1.0.0.29628": {"python_version": "3.10.4"}},
                "vmware": {"2.0.0.43555": {"python_version": "3.10.9"}},
                "unifi-video": {"1.0.0.16705": {"python_version": "3.9.1"}},
                "etl2pcap": {"1.0.0.19032": {"python_version": "3.9.4"}},
                "powershell": {
                    "7.2.1.26295": {"python_version": ""},
                    "7.1.3.22028": {"python_version": ""},
                },
                "python-phash": {"1.0.0.25389": {"python_version": "3.9.8"}},
                "sane-doc-reports": {
                    "1.0.0.27897": {"python_version": "3.9.6"},
                    "1.0.0.24118": {"python_version": "3.9.6"},
                },
                "jq": {"1.0.0.24037": {"python_version": "3.9.6"}},
                "ssl-analyze": {"1.0.0.14890": {"python_version": "3.8.6"}},
                "stringsifter": {"3.20230711.65151": {"python_version": ""}},
                "unzip": {
                    "1.0.0.19258": {"python_version": "3.9.4"},
                    "1.0.0.61858": {"python_version": ""},
                },
                "pwsh-exchange": {"1.0.0.34118": {"python_version": ""}},
                "yarapy": {"1.0.0.10928": {"python_version": "3.8.5"}},
                "bs4-tld": {
                    "1.0.0.63807": {"python_version": "3.10.12"},
                    "1.0.0.21999": {"python_version": "3.9.4"},
                },
                "mlurlphishing": {
                    "1.0.0.28347": {"python_version": "3.9.6"},
                    "1.0.0.61412": {"python_version": "3.10.11"},
                },
                "parse-emails": {
                    "1.0.0.63730": {"python_version": "3.10.12"},
                    "1.0.0.65301": {"python_version": "3.10.12"},
                },
                "ml": {
                    "1.0.0.45981": {"python_version": "3.10.9"},
                    "1.0.0.32340": {"python_version": ""},
                    "1.0.0.20606": {"python_version": "3.9.5"},
                    "1.0.0.62124": {"python_version": "3.10.10"},
                    "1.0.0.23334": {"python_version": "3.9.6"},
                    "1.0.0.30541": {"python_version": "3.9.6"},
                    "1.0.0.57750": {"python_version": "3.10.10"},
                },
                "dl": {"1.5": {"python_version": "2.7.16"}},
                "pandas": {
                    "1.0.0.31117": {"python_version": "3.9.6"},
                    "1.0.0.26289": {"python_version": "3.9.6"},
                },
                "sklearn": {
                    "1.0.0.64885": {"python_version": "3.10.8"},
                    "1.0.0.12410": {"python_version": "3.8.6"},
                    "1.0.0.29944": {"python_version": "3.8.6"},
                    "1.0.0.49796": {"python_version": "3.10.8"},
                },
                "pcap-miner": {
                    "1.0.0.32154": {"python_version": ""},
                    "1.0.0.10664": {"python_version": "3.8.5"},
                    "1.0.0.9769": {"python_version": "3.8.3"},
                    "1.0.0.30520": {"python_version": "3.9.6"},
                },
                "readpdf": {
                    "1.0.0.43274": {"python_version": "3.10.9"},
                    "1.0.0.50963": {"python_version": "3.10.10"},
                },
                "iputils": {"1.0.0.4663": {"python_version": "3.7.5"}},
                "unrar": {"1.4": {"python_version": "2.7.12"}},
                "processing-image-file": {"1.0.0.66515": {"python_version": "3.10.12"}},
                "office-utils": {
                    "2.0.0.54910": {"python_version": "3.10.11"},
                    "2.0.0.49835": {"python_version": "3.10.10"},
                },
                "aquatone": {"2.0.0.36846": {"python_version": "3.10.7"}},
                "pcap-http-extractor": {"1.0.0.32113": {"python_version": ""}},
                "nltk": {"2.0.0.19143": {"python_version": "3.9.4"}},
                "dempcap": {"1.0.0.14059": {"python_version": "2.7.18"}},
                "docxpy": {
                    "1.0.0.40261": {"python_version": "3.10.8"},
                    "1.0.0.33689": {"python_version": ""},
                },
                "ssdeep": {"1.0.0.23743": {"python_version": "3.9.6"}},
                "machine-learning": {"1.0.0.22015": {"python_version": "2.7.18"}},
                "xslxwriter": {"1.0.0.45070": {"python_version": "3.10.9"}},
                "mlclustering": {"1.0.0.23151": {"python_version": "3.9.6"}},
                "sane-pdf-reports": {"1.0.0.62999": {"python_version": "3.10.12"}},
                "fetch-data": {"1.0.0.22177": {"python_version": ""}},
                "rakyll-hey": {"1.0.0.49364": {"python_version": "3.10.10"}},
                "archer": {"1.0.0.270": {"python_version": ""}},
                "powershell-teams": {"1.0.0.22275": {"python_version": ""}},
            }
        }
        # super().__init__(**response.json())
        super().__init__(**a)

    def get_docker_image_metadata_value(
        self, docker_image: str, docker_metadata_key: str
    ) -> str:
        try:
            docker_name, tag = docker_image.replace("demisto/", "").split(":")
            docker_image_metadata = self.docker_images.get(docker_name, {}).get(tag)
            return getattr(docker_image_metadata, docker_metadata_key)
        except (AttributeError, ValueError, TypeError) as err:
            logger.debug(
                f"Could not get {docker_metadata_key} for {docker_image=} because {err=} occurred"
            )
            return ""

    def python_version(self, docker_image: str) -> str:
        return self.get_docker_image_metadata_value(docker_image, "python_version")
