type: map
mapping:
  fromVersion:
    type: str
  toVersion:
    type: str
  incidentFields:
    type: seq
    sequence:
    - include: field_schema

  regex;(fromVersion:(xsoar)|(marketplacev2)|(xpanse)|(xsoar_on_prem)|(xsoar_saas)):
    type: str
  regex;(toVersion:(xsoar)|(marketplacev2)|(xpanse)|(xsoar_on_prem)|(xsoar_saas)):
    type: str
  regex;(incidentFields:(xsoar)|(marketplacev2)|(xpanse)|(xsoar_on_prem)|(xsoar_saas)):
    type: seq
    sequence:
    - include: field_schema

schema;field_schema:
  type: map
  mapping:
    id:
      type: str
      required: true
    version:
      type: number
    modified:
      type: str
    name:
      type: str
      required: true
    name_x2:
      type: str
    prettyName:
      type: str
      required: false
    ownerOnly:
      type: bool
    placeholder:
      type: str
    description:
      type: str
    fieldCalcScript:
      type: str
    cliName:
      type: str
      required: true
    type:
      type: str
      required: true
    closeForm:
      type: bool
    editForm:
      type: bool
    required:
      type: bool
    script:
      type: str
    neverSetAsRequired:
      type: bool
    isReadOnly:
      type: bool
    selectValues:
      type: any
    validationRegex:
      type: str
    useAsKpi:
      type: bool
    locked:
      type: bool
    system:
      type: bool
    group:
      type: number
    hidden:
      type: bool
    columns:
      type: any
    defaultRows:
      type: any
    threshold:
      type: number
    sla:
      type: number
    caseInsensitive:
      type: bool
    breachScript:
      type: str
    associatedTypes:
      type: any
    systemAssociatedTypes:
      type: any
    associatedToAll:
      type: bool
    unmapped:
      type: bool
    content:
      type: bool
    unsearchable:
      type: bool
    marketplaces:
      type: seq
      sequence:
      - type: str
        enum: ['xsoar', 'marketplacev2', 'xpanse', 'xsoar_saas', 'xsoar_on_prem']
    Aliases:
      type: seq
      sequence:
      - include: aliases_schema
    aliasTo:
      type: str

schema;aliases_schema:
  type: map
  mapping:
    cliName:
      type: str
    type:
      type: str
      enum: ['shortText', 'longText', 'boolean', 'singleSelect', 'multiSelect', 'date', 'user', 'role', 'number', 'attachments', 'tagsSelect', 'internal', 'url', 'markdown', 'grid', 'timer', 'html']
