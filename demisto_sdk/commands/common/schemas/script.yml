type: map
mapping:
  commonfields:
    type: map
    required: true
    mapping:
      id:
        type: str
        required: true
      id_x2:
        type: str
      version:
        type: int
        required: true
  name:
    type: str
    required: true
  name_x2:
    type: str
  script:
    type: str
    required: true
  type:
    type: str
    required: true
    enum: ['javascript', 'python', 'powershell']
  tags:
    type: seq
    sequence:
    - type: str
  comment:
    type: str
    required: true
  comment_x2:
    type: str
  enabled:
    type: bool
  system:
    type: bool
  deprecated:
    type: bool
  args:
    type: seq
    sequence:
    - include: argument_schema
  scripttarget:
    type: int
  timeout:
    type: text
  dependson:
    type: map
    allowempty: true
  dependson_x2:
    type: map
    allowempty: true
  outputs:
    type: seq
    sequence:
    - include: output_schema
  important:
    type: seq
    sequence:
    - include: important_schema
  fromversion:
    type: text
  toversion:
    type: text
  dockerimage:
    type: str
  dockerimage45:
    type: str
  alt_dockerimages:
    type: seq
    sequence:
    - type: str
  nativeImage:
    type: seq
    sequence:
    - type: str
  runonce:
    type: bool
  tests:
    type: seq
    sequence:
    - type: str
  sensitive:
    type: bool
  runas:
    type: str
  subtype:
    type: str
    enum: ['python2', 'python3']
  engineinfo:
    type: map
    mapping:
      engine:
        type: str
  contentitemexportablefields:
    type: map
    mapping:
      contentitemfields:
        type: map
        mapping:
          fromServerVersion:
            type: str
  polling:
    type: bool
  autoUpdateDockerImage:
    type: bool
  marketplaces:
    type: seq
    sequence:
    - type: str
      enum: ['xsoar', 'marketplacev2', 'xpanse', 'xsoar_saas', 'xsoar_on_prem']
  skipprepare:
    type: seq
    sequence:
    - type: str
      enum: ['script-name-incident-to-alert']

# script->args
  regex;(name:(xsoar)|(marketplacev2)|(xpanse)|(xsoar_on_prem)|(xsoar_saas)):
    type: str
schema;argument_schema:
  type: map
  mapping:
    name:
      type: str
      required: true
    description:
      type: str
      required: true
    description_x2:
      type: str
    defaultValue:
      type: str
    required:
      type: bool
    default:
      type: bool
    auto:
      type: str
      enum: ['PREDEFINED']
    predefined:
      type: seq
      sequence:
      - type: str
    isArray:
      type: bool
    secret:
      type: bool
    deprecated:
      type: bool
    type:
      type: str
    hidden:
      type: bool

# script->outputs
    regex;(name:(xsoar)|(marketplacev2)|(xpanse)|(xsoar_on_prem)|(xsoar_saas)):
      type: str
    regex;(description:(xsoar)|(marketplacev2)|(xpanse)|(xsoar_on_prem)|(xsoar_saas)):
      type: str
    regex;(defaultValue:(xsoar)|(marketplacev2)|(xpanse)|(xsoar_on_prem)|(xsoar_saas)):
      type: str
    regex;(required:(xsoar)|(marketplacev2)|(xpanse)|(xsoar_on_prem)|(xsoar_saas)):
      type: bool
schema;output_schema:
  type: map
  mapping:
    contentPath:
      type: str
    contextPath:
      type: scalar
    description:
      type: str
      required: true
    description_x2:
      type: str
    type:
      type: str

# script->important
    regex;(description:(xsoar)|(marketplacev2)|(xpanse)|(xsoar_on_prem)|(xsoar_saas)):
      type: str
schema;important_schema:
  type: map
  mapping:
    contextPath:
      type: str
      required: true
    description:
      type: str
      required: true
    description_x2:
      type: str
    related:
      type: str
    regex;(description:(xsoar)|(marketplacev2)|(xpanse)|(xsoar_on_prem)|(xsoar_saas)):
      type: str
