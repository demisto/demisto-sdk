type: map
mapping:
  trigger_id:
    type: str
    required: true
  fromVersion:
    type: str
  toVersion:
    type: str
  trigger_name:
    type: str
    required: true
  playbook_id:
    type: str
    required: true
  description:
    type: str
    required: true
  suggestion_reason:
    type: str
    required: true
  alerts_filter:
    type: map
    mapping:
      filter:
        type: map
        mapping:
          OR:
            type: seq
            required: false
            sequence:
            - include: filter_schema
          AND:
            type: seq
            required: false
            sequence:
            - include: filter_schema


          regex;OR:(xsoar)|(marketplacev2)|(xpanse)|(xsoar_on_prem)|(xsoar_saas):
            type: seq
            sequence:
            - include: filter_schema
          regex;AND:(xsoar)|(marketplacev2)|(xpanse)|(xsoar_on_prem)|(xsoar_saas):
            type: seq
            sequence:
            - include: filter_schema


  regex;trigger_id:(xsoar)|(marketplacev2)|(xpanse)|(xsoar_on_prem)|(xsoar_saas):
    type: str
  regex;fromVersion:(xsoar)|(marketplacev2)|(xpanse)|(xsoar_on_prem)|(xsoar_saas):
    type: str
  regex;toVersion:(xsoar)|(marketplacev2)|(xpanse)|(xsoar_on_prem)|(xsoar_saas):
    type: str
  regex;trigger_name:(xsoar)|(marketplacev2)|(xpanse)|(xsoar_on_prem)|(xsoar_saas):
    type: str
  regex;playbook_id:(xsoar)|(marketplacev2)|(xpanse)|(xsoar_on_prem)|(xsoar_saas):
    type: str
  regex;description:(xsoar)|(marketplacev2)|(xpanse)|(xsoar_on_prem)|(xsoar_saas):
    type: str
  regex;suggestion_reason:(xsoar)|(marketplacev2)|(xpanse)|(xsoar_on_prem)|(xsoar_saas):
    type: str
schema;filter_schema:
  type: map
  mapping:
    SEARCH_FIELD:
      type: str
      required: true
    SEARCH_TYPE:
      type: str
      required: true
    SEARCH_VALUE:
      type: str
      required: true
