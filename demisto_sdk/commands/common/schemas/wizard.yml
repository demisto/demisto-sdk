type: map
mapping:
  id:
    type: str
    required: true
  version:
    type: int
  name:
    type: str
    required: true
  modified:
    type: str
  description:
    type: str
  system:
    type: bool
  deprecated:
    type: bool
  fromVersion:
    type: str
    required: true
  toVersion:
    type: str
  dependency_packs:
    type: seq
    required: true
    sequence:
    - type: map
      required: true
      mapping:
        name:
          type: str
          required: true
        min_required:
          type: int
          required: true
        packs:
          type: seq
          required: true
          sequence:
          - type: map
            mapping:
              name:
                type: str
              display_name:
                type: str
  wizard:
    type: map
    required: true
    mapping:
      fetching_integrations:
        type: seq
        required: true
        sequence:
        - include: integrations_schema
      supporting_integrations:
        type: seq
        required: true
        sequence:
        - include: integrations_schema
      set_playbook:
        type: seq
        required: true
        sequence:
        - include: playbook_schema
      next:
        type: seq
        sequence:
        - include: next_schema

      regex;fetching_integrations:(xsoar)|(marketplacev2)|(xpanse)|(xsoar_on_prem)|(xsoar_saas):
        type: seq
        sequence:
        - include: integrations_schema
      regex;supporting_integrations:(xsoar)|(marketplacev2)|(xpanse)|(xsoar_on_prem)|(xsoar_saas):
        type: seq
        sequence:
        - include: integrations_schema
      regex;set_playbook:(xsoar)|(marketplacev2)|(xpanse)|(xsoar_on_prem)|(xsoar_saas):
        type: seq
        sequence:
        - include: playbook_schema
      regex;next:(xsoar)|(marketplacev2)|(xpanse)|(xsoar_on_prem)|(xsoar_saas):
        type: seq
        sequence:
        - include: next_schema

  regex;version:(xsoar)|(marketplacev2)|(xpanse)|(xsoar_on_prem)|(xsoar_saas):
    type: int
  regex;name:(xsoar)|(marketplacev2)|(xpanse)|(xsoar_on_prem)|(xsoar_saas):
    type: str
  regex;modified:(xsoar)|(marketplacev2)|(xpanse)|(xsoar_on_prem)|(xsoar_saas):
    type: str
  regex;description:(xsoar)|(marketplacev2)|(xpanse)|(xsoar_on_prem)|(xsoar_saas):
    type: str
  regex;system:(xsoar)|(marketplacev2)|(xpanse)|(xsoar_on_prem)|(xsoar_saas):
    type: bool
  regex;deprecated:(xsoar)|(marketplacev2)|(xpanse)|(xsoar_on_prem)|(xsoar_saas):
    type: bool
  regex;fromVersion:(xsoar)|(marketplacev2)|(xpanse)|(xsoar_on_prem)|(xsoar_saas):
    type: str
  regex;toVersion:(xsoar)|(marketplacev2)|(xpanse)|(xsoar_on_prem)|(xsoar_saas):
    type: str
  regex;dependency_packs:(xsoar)|(marketplacev2)|(xpanse)|(xsoar_on_prem)|(xsoar_saas):
    type: seq
    sequence:
    - type: map
      required: true
      mapping:
        name:
          type: str
          required: true
        min_required:
          type: int
          required: true
        packs:
          type: seq
          required: true
          sequence:
          - type: map
            mapping:
              name:
                type: str
              display_name:
                type: str
schema;integrations_schema:
  type: map
  mapping:
    name:
      type: str
      required: true
    description:
      type: str
      required: true
    action:
      type: map
      required: true
      mapping:
        existing:
          type: str
        new:
          type: str
    priority:
      type: int
    incident_type:
      type: str

schema;playbook_schema:
  type: map
  mapping:
    name:
      type: str
      required: true
    link_to_integration:
      type: str

schema;next_schema:
  type: map
  required: true
  mapping:
    name:
      type: str
      required: true
    action:
      type: map
      required: true
      mapping:
        existing:
          type: str
        new:
          type: str
