category: Utilities
commonfields:
  id: VirusTotal Test
  version: -1
configuration:
- defaultvalue: ''
  display: Server URL
  name: url
  required: true
  type: 0
- display: API Key
  name: api_key
  required: true
  type: 4
- display: Use system proxy
  name: proxy
  required: false
  type: 8
- display: Trust any certificate
  name: insecure
  required: false
  type: 8
description: Virus Total collection description
display: VirusTotal Test
name: VirusTotal Test
vcShouldKeepItemLegacyProdMachine: false
image: data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAAF8ElEQVRo3tVaa2wUVRQ+lUeolLZQHwQxEUIi/GgpakvTst2d7fax7RaEUFOIRW2x7e7cme220BawNSQ1MQZFgYaH8gvlFVAxUYIIJPxRA7FSLCpBJMYnL5FEyh8cvzttodvd6e527izpJCezO3Pn3Pvde853zzkzRKKPAmUOScp+Kg/MoVF7FCiZJLHz5JA1nL8jlzxzxLoklgw908iBc5xBZKPTSzqIAcmvPU3Ltk+NSc/S5vGUz9YASBd0XIXOb2jpKm+cQDAnOvw9CAQXm1ej0ubj9PW5yVHpaXplLJU3bKN83xA9+F+gtJAnkGAdCIm50dm1EBADYgeYrJrDlF0d2UTscj7ZfXcMdN2kJW2PWwPCIZdC/jYEESwHATopwsquHVZHgb9IPAinvhI3owTRJ5L8ITm8xisjye8N+7xLtQk2JyUHPnElJhB3CcB7hCpff9TATI8bPmfzXUCfqeJAuPyzoPinEYEYkMKGr8jtnztkhbmZ3gr1MYiTXaPFgWKRFDuenMpBUyD0wemsBGqVt2EVWmgRmMoh3wjTthdAdlGpP120cz8EO/7FNJBQswm95mR7qKTBoujAqUzADJ4QDiREWDe5lInWbn5FgWysyiEAOmNgDuZFkt+N107+AGw3hUrU6VSsLsTvo4LBHMFEJVDcD7syBh1vEQikFz5SRPflkNRU2PY5cebF/oBPLjM/sMWBVEShKpRuJxeLjsMdyibx/sL2UUXHCNmrtiUZ9n/0bhSaW3uL1A2RuVxiqy1ismvQvR7ycKxx1GuUP0hRdo1GLVvfjsK8NlpMzRdhbowKlSmRQVSumg/kt4csr0Y5dZepyvuEMXh/Ctr1kA1t56vDC28jmaLnbkQZ9VSoJhqxzzh08rmhguyXPqI9xxINzOotPsDkhbXavMZlWmZgeVjh93gbHYx5//kWYFZQkfLg0P2hAg3+M3xwQb1GFe0nacVaDz3XOB3m9xiU5UP64i/M9rzG5dq+6xnanqsZ2u4rc4OEX+P3eBt9ZYQRgnf/4IAwERe7IsyARnl1PBTX9IRKYteD7mNwfNb5gD+4nKG9/9fcIOHX+D3eRggQbp42Pp616wYBUVeaVtwPhM8+H/iuPzODhF/j94QB4RNaFviR1h1K6wPxYkcyZvqHUQckC2y6utN3bzWatzDKqtZGHZDcuh56oWNSH4h3dqRRSdP5frsfXUAkVn1vNTxyO+V5zfG6GGe/ohMIn1BOKFJEej5NBfKEwfHRAWE0OBL6ldh+0H4ussRpOqVXrfFQRdtJneqN+7qD+G9J8N7hbkzEalRBusynrDFuiE7lzbCbK990s6s/Ns732WGkweMMQgxs95JSB0BnzPF61CHKWVC+cY1rZWAG5fmuhs1Vlq96JprsbzLyZRmoL1gaADrZGxHHsiSwKagwwUtDLmV9rBEwKiasvb9sY0FezgIRx/BsUybCoN5Bz32G2CppZLlJTfNssrO94sEoG6MrCLIytN8KS/EB/CQBNS1WCflNIJgeOHvKfcrLlULd2YT5ibwZ5zHxB+JAicbBjgg1MV5KcjcuIk/TdFBrKnwzTsCcyk6LmIynBd04f0Lu1qctNi05CZ2dtbxkKiknyNmQaA0Il5qOTkLDmZyXrQDzMyRNLACPmgmlu+Ebt0MTG991Yhs6sUM34n6nvufYTfsMJ4G9VMjGigNR0+LRbTf84P4lW31wWdOtZlCx8qUpMPw9fZEyUxyI1rYpCA8uGQ5Kkr8I+5y39RFa4Ds8QiCXwVpZYk2q1C9FeIexw/BZm5yMmY01PbgBJ7egcF3oLxnWjl1Kc4Ty6USAPRBDSbTYGpZqacMGJf8TvnqBxEaS8yLqyKpJhnyqfzRgHPrzzzQsfIWweE0CuHw12euHMpVG5f7N+Nwiuh2Yf77hbj6mf84Rap6/YoO1x2cnL3m1Dp2e0h1RwtkuB5CSxhZGPL9zKj4UONX/NncAxEWS/E/FOcaSJ+mfHDlNhNFlrTP0l5x9weL38LF0GrWHq2m2/uLGpT4pWvX/zRDqQjZWrVoAAAAASUVORK5CYII=
detaileddescription: |-
  ## Hello World
  - This section explains how to configure the instance of HelloWorld in Cortex XSOAR.
  - You can use the following API Key: `43ea9b2d-4998-43a6-ae91-aba62a26868c`
script:
  commands:
  - arguments:
    - description: ''
      isArray: false
      name: resource
      required: false
    description: URL Report description
    name: vt-test-url-report
    outputs:
    - contextPath: VirusTotalTest.scan_id
      description: ''
      type: String
    - contextPath: VirusTotalTest.resource
      description: ''
      type: String
    - contextPath: VirusTotalTest.url
      description: ''
      type: String
    - contextPath: VirusTotalTest.response_code
      description: ''
      type: Number
    - contextPath: VirusTotalTest.scan_date
      description: ''
      type: Date
    - contextPath: VirusTotalTest.permalink
      description: ''
      type: String
    - contextPath: VirusTotalTest.verbose_msg
      description: ''
      type: String
    - contextPath: VirusTotalTest.filescan_id
      description: ''
      type: Unknown
    - contextPath: VirusTotalTest.positives
      description: ''
      type: Number
    - contextPath: VirusTotalTest.total
      description: ''
      type: Number
    - contextPath: VirusTotalTest.scans.CMC Threat Intelligence.detected
      description: ''
      type: Boolean
    - contextPath: VirusTotalTest.scans.CMC Threat Intelligence.result
      description: ''
      type: String
    - contextPath: VirusTotalTest.scans.CLEAN MX.detected
      description: ''
      type: Boolean
    - contextPath: VirusTotalTest.scans.CLEAN MX.result
      description: ''
      type: String
    - contextPath: VirusTotalTest.scans.DNS8.detected
      description: ''
      type: Boolean
    - contextPath: VirusTotalTest.scans.DNS8.result
      description: ''
      type: String
    - contextPath: VirusTotalTest.scans.MalSilo.detected
      description: ''
      type: Boolean
    - contextPath: VirusTotalTest.scans.MalSilo.result
      description: ''
      type: String
    - contextPath: VirusTotalTest.scans.NotMining.detected
      description: ''
      type: Boolean
    - contextPath: VirusTotalTest.scans.NotMining.result
      description: ''
      type: String
    - contextPath: VirusTotalTest.scans.AICC (MONITORAPP).detected
      description: ''
      type: Boolean
    - contextPath: VirusTotalTest.scans.AICC (MONITORAPP).result
      description: ''
      type: String
    - contextPath: VirusTotalTest.scans.VX Vault.detected
      description: ''
      type: Boolean
    - contextPath: VirusTotalTest.scans.VX Vault.result
      description: ''
      type: String
    - contextPath: VirusTotalTest.scans.securolytics.detected
      description: ''
      type: Boolean
    - contextPath: VirusTotalTest.scans.securolytics.result
      description: ''
      type: String
    - contextPath: VirusTotalTest.scans.Tencent.detected
      description: ''
      type: Boolean
    - contextPath: VirusTotalTest.scans.Tencent.result
      description: ''
      type: String
    - contextPath: VirusTotalTest.scans.MalwarePatrol.detected
      description: ''
      type: Boolean
    - contextPath: VirusTotalTest.scans.MalwarePatrol.result
      description: ''
      type: String
    - contextPath: VirusTotalTest.scans.Armis.detected
      description: ''
      type: Boolean
    - contextPath: VirusTotalTest.scans.Armis.result
      description: ''
      type: String
    - contextPath: VirusTotalTest.scans.MalBeacon.detected
      description: ''
      type: Boolean
    - contextPath: VirusTotalTest.scans.MalBeacon.result
      description: ''
      type: String
    - contextPath: VirusTotalTest.scans.Comodo Valkyrie Verdict.detected
      description: ''
      type: Boolean
    - contextPath: VirusTotalTest.scans.Comodo Valkyrie Verdict.result
      description: ''
      type: String
    - contextPath: VirusTotalTest.scans.PhishLabs.detected
      description: ''
      type: Boolean
    - contextPath: VirusTotalTest.scans.PhishLabs.result
      description: ''
      type: String
    - contextPath: VirusTotalTest.scans.EmergingThreats.detected
      description: ''
      type: Boolean
    - contextPath: VirusTotalTest.scans.EmergingThreats.result
      description: ''
      type: String
    - contextPath: VirusTotalTest.scans.Sangfor.detected
      description: ''
      type: Boolean
    - contextPath: VirusTotalTest.scans.Sangfor.result
      description: ''
      type: String
    - contextPath: VirusTotalTest.scans.K7AntiVirus.detected
      description: ''
      type: Boolean
    - contextPath: VirusTotalTest.scans.K7AntiVirus.result
      description: ''
      type: String
    - contextPath: VirusTotalTest.scans.Virusdie External Site Scan.detected
      description: ''
      type: Boolean
    - contextPath: VirusTotalTest.scans.Virusdie External Site Scan.result
      description: ''
      type: String
    - contextPath: VirusTotalTest.scans.Artists Against 419.detected
      description: ''
      type: Boolean
    - contextPath: VirusTotalTest.scans.Artists Against 419.result
      description: ''
      type: String
    - contextPath: VirusTotalTest.scans.CINS Army.detected
      description: ''
      type: Boolean
    - contextPath: VirusTotalTest.scans.CINS Army.result
      description: ''
      type: String
    - contextPath: VirusTotalTest.scans.Cyren.detected
      description: ''
      type: Boolean
    - contextPath: VirusTotalTest.scans.Cyren.result
      description: ''
      type: String
    - contextPath: VirusTotalTest.scans.Quttera.detected
      description: ''
      type: Boolean
    - contextPath: VirusTotalTest.scans.Quttera.result
      description: ''
      type: String
    - contextPath: VirusTotalTest.scans.AegisLab WebGuard.detected
      description: ''
      type: Boolean
    - contextPath: VirusTotalTest.scans.AegisLab WebGuard.result
      description: ''
      type: String
    - contextPath: VirusTotalTest.scans.MalwareDomainList.detected
      description: ''
      type: Boolean
    - contextPath: VirusTotalTest.scans.MalwareDomainList.result
      description: ''
      type: String
    - contextPath: VirusTotalTest.scans.MalwareDomainList.detail
      description: ''
      type: String
    - contextPath: VirusTotalTest.scans.Lumu.detected
      description: ''
      type: Boolean
    - contextPath: VirusTotalTest.scans.Lumu.result
      description: ''
      type: String
    - contextPath: VirusTotalTest.scans.zvelo.detected
      description: ''
      type: Boolean
    - contextPath: VirusTotalTest.scans.zvelo.result
      description: ''
      type: String
    - contextPath: VirusTotalTest.scans.Google Safebrowsing.detected
      description: ''
      type: Boolean
    - contextPath: VirusTotalTest.scans.Google Safebrowsing.result
      description: ''
      type: String
    - contextPath: VirusTotalTest.scans.Kaspersky.detected
      description: ''
      type: Boolean
    - contextPath: VirusTotalTest.scans.Kaspersky.result
      description: ''
      type: String
    - contextPath: VirusTotalTest.scans.BitDefender.detected
      description: ''
      type: Boolean
    - contextPath: VirusTotalTest.scans.BitDefender.result
      description: ''
      type: String
    - contextPath: VirusTotalTest.scans.GreenSnow.detected
      description: ''
      type: Boolean
    - contextPath: VirusTotalTest.scans.GreenSnow.result
      description: ''
      type: String
    - contextPath: VirusTotalTest.scans.IPsum.detected
      description: ''
      type: Boolean
    - contextPath: VirusTotalTest.scans.IPsum.result
      description: ''
      type: String
    - contextPath: VirusTotalTest.scans.G-Data.detected
      description: ''
      type: Boolean
    - contextPath: VirusTotalTest.scans.G-Data.result
      description: ''
      type: String
    - contextPath: VirusTotalTest.scans.CyberCrime.detected
      description: ''
      type: Boolean
    - contextPath: VirusTotalTest.scans.CyberCrime.result
      description: ''
      type: String
    - contextPath: VirusTotalTest.scans.Malware Domain Blocklist.detected
      description: ''
      type: Boolean
    - contextPath: VirusTotalTest.scans.Malware Domain Blocklist.result
      description: ''
      type: String
    - contextPath: VirusTotalTest.scans.AutoShun.detected
      description: ''
      type: Boolean
    - contextPath: VirusTotalTest.scans.AutoShun.result
      description: ''
      type: String
    - contextPath: VirusTotalTest.scans.Feodo Tracker.detected
      description: ''
      type: Boolean
    - contextPath: VirusTotalTest.scans.Feodo Tracker.result
      description: ''
      type: String
    - contextPath: VirusTotalTest.scans.Web Security Guard.detected
      description: ''
      type: Boolean
    - contextPath: VirusTotalTest.scans.Web Security Guard.result
      description: ''
      type: String
    - contextPath: VirusTotalTest.scans.Cyan.detected
      description: ''
      type: Boolean
    - contextPath: VirusTotalTest.scans.Cyan.result
      description: ''
      type: String
    - contextPath: VirusTotalTest.scans.CyRadar.detected
      description: ''
      type: Boolean
    - contextPath: VirusTotalTest.scans.CyRadar.result
      description: ''
      type: String
    - contextPath: VirusTotalTest.scans.desenmascara.me.detected
      description: ''
      type: Boolean
    - contextPath: VirusTotalTest.scans.desenmascara.me.result
      description: ''
      type: String
    - contextPath: VirusTotalTest.scans.ADMINUSLabs.detected
      description: ''
      type: Boolean
    - contextPath: VirusTotalTest.scans.ADMINUSLabs.result
      description: ''
      type: String
    - contextPath: VirusTotalTest.scans.SCUMWARE.org.detected
      description: ''
      type: Boolean
    - contextPath: VirusTotalTest.scans.SCUMWARE.org.result
      description: ''
      type: String
    - contextPath: VirusTotalTest.scans.Dr.Web.detected
      description: ''
      type: Boolean
    - contextPath: VirusTotalTest.scans.Dr.Web.result
      description: ''
      type: String
    - contextPath: VirusTotalTest.scans.AlienVault.detected
      description: ''
      type: Boolean
    - contextPath: VirusTotalTest.scans.AlienVault.result
      description: ''
      type: String
    - contextPath: VirusTotalTest.scans.Emsisoft.detected
      description: ''
      type: Boolean
    - contextPath: VirusTotalTest.scans.Emsisoft.result
      description: ''
      type: String
    - contextPath: VirusTotalTest.scans.Spamhaus.detected
      description: ''
      type: Boolean
    - contextPath: VirusTotalTest.scans.Spamhaus.result
      description: ''
      type: String
    - contextPath: VirusTotalTest.scans.malwares.com URL checker.detected
      description: ''
      type: Boolean
    - contextPath: VirusTotalTest.scans.malwares.com URL checker.result
      description: ''
      type: String
    - contextPath: VirusTotalTest.scans.Phishtank.detected
      description: ''
      type: Boolean
    - contextPath: VirusTotalTest.scans.Phishtank.result
      description: ''
      type: String
    - contextPath: VirusTotalTest.scans.EonScope.detected
      description: ''
      type: Boolean
    - contextPath: VirusTotalTest.scans.EonScope.result
      description: ''
      type: String
    - contextPath: VirusTotalTest.scans.Malwared.detected
      description: ''
      type: Boolean
    - contextPath: VirusTotalTest.scans.Malwared.result
      description: ''
      type: String
    - contextPath: VirusTotalTest.scans.Avira.detected
      description: ''
      type: Boolean
    - contextPath: VirusTotalTest.scans.Avira.result
      description: ''
      type: String
    - contextPath: VirusTotalTest.scans.Cisco Talos IP Blacklist.detected
      description: ''
      type: Boolean
    - contextPath: VirusTotalTest.scans.Cisco Talos IP Blacklist.result
      description: ''
      type: String
    - contextPath: VirusTotalTest.scans.OpenPhish.detected
      description: ''
      type: Boolean
    - contextPath: VirusTotalTest.scans.OpenPhish.result
      description: ''
      type: String
    - contextPath: VirusTotalTest.scans.Antiy-AVL.detected
      description: ''
      type: Boolean
    - contextPath: VirusTotalTest.scans.Antiy-AVL.result
      description: ''
      type: String
    - contextPath: VirusTotalTest.scans.Forcepoint ThreatSeeker.detected
      description: ''
      type: Boolean
    - contextPath: VirusTotalTest.scans.Forcepoint ThreatSeeker.result
      description: ''
      type: String
    - contextPath: VirusTotalTest.scans.Spam404.detected
      description: ''
      type: Boolean
    - contextPath: VirusTotalTest.scans.Spam404.result
      description: ''
      type: String
    - contextPath: VirusTotalTest.scans.Trustwave.detected
      description: ''
      type: Boolean
    - contextPath: VirusTotalTest.scans.Trustwave.result
      description: ''
      type: String
    - contextPath: VirusTotalTest.scans.Certego.detected
      description: ''
      type: Boolean
    - contextPath: VirusTotalTest.scans.Certego.result
      description: ''
      type: String
    - contextPath: VirusTotalTest.scans.URLhaus.detected
      description: ''
      type: Boolean
    - contextPath: VirusTotalTest.scans.URLhaus.result
      description: ''
      type: String
    - contextPath: VirusTotalTest.scans.Yandex Safebrowsing.detected
      description: ''
      type: Boolean
    - contextPath: VirusTotalTest.scans.Yandex Safebrowsing.result
      description: ''
      type: String
    - contextPath: VirusTotalTest.scans.Yandex Safebrowsing.detail
      description: ''
      type: String
    - contextPath: VirusTotalTest.scans.ESET.detected
      description: ''
      type: Boolean
    - contextPath: VirusTotalTest.scans.ESET.result
      description: ''
      type: String
    - contextPath: VirusTotalTest.scans.Threatsourcing.detected
      description: ''
      type: Boolean
    - contextPath: VirusTotalTest.scans.Threatsourcing.result
      description: ''
      type: String
    - contextPath: VirusTotalTest.scans.BlockList.detected
      description: ''
      type: Boolean
    - contextPath: VirusTotalTest.scans.BlockList.result
      description: ''
      type: String
    - contextPath: VirusTotalTest.scans.SecureBrain.detected
      description: ''
      type: Boolean
    - contextPath: VirusTotalTest.scans.SecureBrain.result
      description: ''
      type: String
    - contextPath: VirusTotalTest.scans.Nucleon.detected
      description: ''
      type: Boolean
    - contextPath: VirusTotalTest.scans.Nucleon.result
      description: ''
      type: String
    - contextPath: VirusTotalTest.scans.PREBYTES.detected
      description: ''
      type: Boolean
    - contextPath: VirusTotalTest.scans.PREBYTES.result
      description: ''
      type: String
    - contextPath: VirusTotalTest.scans.Sophos.detected
      description: ''
      type: Boolean
    - contextPath: VirusTotalTest.scans.Sophos.result
      description: ''
      type: String
    - contextPath: VirusTotalTest.scans.Blueliv.detected
      description: ''
      type: Boolean
    - contextPath: VirusTotalTest.scans.Blueliv.result
      description: ''
      type: String
    - contextPath: VirusTotalTest.scans.Hoplite Industries.detected
      description: ''
      type: Boolean
    - contextPath: VirusTotalTest.scans.Hoplite Industries.result
      description: ''
      type: String
    - contextPath: VirusTotalTest.scans.Netcraft.detected
      description: ''
      type: Boolean
    - contextPath: VirusTotalTest.scans.Netcraft.result
      description: ''
      type: String
    - contextPath: VirusTotalTest.scans.CRDF.detected
      description: ''
      type: Boolean
    - contextPath: VirusTotalTest.scans.CRDF.result
      description: ''
      type: String
    - contextPath: VirusTotalTest.scans.ThreatHive.detected
      description: ''
      type: Boolean
    - contextPath: VirusTotalTest.scans.ThreatHive.result
      description: ''
      type: String
    - contextPath: VirusTotalTest.scans.BADWARE.INFO.detected
      description: ''
      type: Boolean
    - contextPath: VirusTotalTest.scans.BADWARE.INFO.result
      description: ''
      type: String
    - contextPath: VirusTotalTest.scans.FraudScore.detected
      description: ''
      type: Boolean
    - contextPath: VirusTotalTest.scans.FraudScore.result
      description: ''
      type: String
    - contextPath: VirusTotalTest.scans.Quick Heal.detected
      description: ''
      type: Boolean
    - contextPath: VirusTotalTest.scans.Quick Heal.result
      description: ''
      type: String
    - contextPath: VirusTotalTest.scans.Rising.detected
      description: ''
      type: Boolean
    - contextPath: VirusTotalTest.scans.Rising.result
      description: ''
      type: String
    - contextPath: VirusTotalTest.scans.StopBadware.detected
      description: ''
      type: Boolean
    - contextPath: VirusTotalTest.scans.StopBadware.result
      description: ''
      type: String
    - contextPath: VirusTotalTest.scans.Sucuri SiteCheck.detected
      description: ''
      type: Boolean
    - contextPath: VirusTotalTest.scans.Sucuri SiteCheck.result
      description: ''
      type: String
    - contextPath: VirusTotalTest.scans.Fortinet.detected
      description: ''
      type: Boolean
    - contextPath: VirusTotalTest.scans.Fortinet.result
      description: ''
      type: String
    - contextPath: VirusTotalTest.scans.StopForumSpam.detected
      description: ''
      type: Boolean
    - contextPath: VirusTotalTest.scans.StopForumSpam.result
      description: ''
      type: String
    - contextPath: VirusTotalTest.scans.ZeroCERT.detected
      description: ''
      type: Boolean
    - contextPath: VirusTotalTest.scans.ZeroCERT.result
      description: ''
      type: String
    - contextPath: VirusTotalTest.scans.Baidu-International.detected
      description: ''
      type: Boolean
    - contextPath: VirusTotalTest.scans.Baidu-International.result
      description: ''
      type: String
    - contextPath: VirusTotalTest.scans.Phishing Database.detected
      description: ''
      type: Boolean
    - contextPath: VirusTotalTest.scans.Phishing Database.result
      description: ''
      type: String
  - arguments:
    - description: ''
      isArray: false
      name: domain
      required: false
    description: Domain Report description
    name: vt-test-domain-report
    outputs:
    - contextPath: VirusTotalTest.undetected_downloaded_samples.date
      description: ''
      type: Date
    - contextPath: VirusTotalTest.undetected_downloaded_samples.positives
      description: ''
      type: Number
    - contextPath: VirusTotalTest.undetected_downloaded_samples.total
      description: ''
      type: Number
    - contextPath: VirusTotalTest.undetected_downloaded_samples.sha256
      description: ''
      type: String
    - contextPath: VirusTotalTest.whois_timestamp
      description: ''
      type: Number
    - contextPath: VirusTotalTest.detected_downloaded_samples.date
      description: ''
      type: Date
    - contextPath: VirusTotalTest.detected_downloaded_samples.positives
      description: ''
      type: Number
    - contextPath: VirusTotalTest.detected_downloaded_samples.total
      description: ''
      type: Number
    - contextPath: VirusTotalTest.detected_downloaded_samples.sha256
      description: ''
      type: String
    - contextPath: VirusTotalTest.Forcepoint ThreatSeeker category
      description: ''
      type: String
    - contextPath: VirusTotalTest.undetected_urls
      description: ''
      type: Date
    - contextPath: VirusTotalTest.Comodo Valkyrie Verdict category
      description: ''
      type: String
    - contextPath: VirusTotalTest.undetected_referrer_samples.date
      description: ''
      type: Date
    - contextPath: VirusTotalTest.undetected_referrer_samples.positives
      description: ''
      type: Number
    - contextPath: VirusTotalTest.undetected_referrer_samples.total
      description: ''
      type: Number
    - contextPath: VirusTotalTest.undetected_referrer_samples.sha256
      description: ''
      type: String
    - contextPath: VirusTotalTest.resolutions.last_resolved
      description: ''
      type: Date
    - contextPath: VirusTotalTest.resolutions.ip_address
      description: ''
      type: String
    - contextPath: VirusTotalTest.subdomains
      description: ''
      type: String
    - contextPath: VirusTotalTest.sophos category
      description: ''
      type: String
    - contextPath: VirusTotalTest.whois
      description: ''
      type: String
    - contextPath: VirusTotalTest.response_code
      description: ''
      type: Number
    - contextPath: VirusTotalTest.verbose_msg
      description: ''
      type: String
  - description: File scan description
    name: vt-test-file-scan
    outputs:
    - contextPath: VirusTotalTest.scan_id
      description: ''
      type: String
    - contextPath: VirusTotalTest.sha1
      description: ''
      type: String
    - contextPath: VirusTotalTest.resource
      description: ''
      type: String
    - contextPath: VirusTotalTest.response_code
      description: ''
      type: Number
    - contextPath: VirusTotalTest.sha256
      description: ''
      type: String
    - contextPath: VirusTotalTest.permalink
      description: ''
      type: String
    - contextPath: VirusTotalTest.md5
      description: ''
      type: String
    - contextPath: VirusTotalTest.verbose_msg
      description: ''
      type: String
  - arguments:
    - description: ''
      isArray: false
      name: hash
      required: false
    description: file download description
    name: vt-test-file-download
  dockerimage: demisto/python3:3.8.6.12176
  isfetch: false
  script: |2




    class Client(BaseClient):
        def __init__(self, server_url, verify, proxy, headers, auth):
            super().__init__(base_url=server_url, verify=verify,
                             proxy=proxy, headers=headers, auth=auth)

        def url_report_request(self, resource):
            params = assign_params(resource=resource)

            headers = self._headers

            response = self._http_request(
                'GET', 'url/report', params=params, headers=headers)

            return response

        def domain_report_request(self, domain):
            params = assign_params(domain=domain)

            headers = self._headers

            response = self._http_request(
                'GET', 'domain/report', params=params, headers=headers)

            return response

        def file_scan_request(self):

            headers = self._headers

            response = self._http_request('POST', 'file/scan', headers=headers)

            return response

        def file_download_request(self, hash):
            params = assign_params(hash=hash)

            headers = self._headers

            response = self._http_request(
                'GET', 'vtapi/v2/file/download', params=params, headers=headers)

            return response


    def url_report_command(client, args):
        resource = str(args.get('resource', ''))

        response = client.url_report_request(resource)
        command_results = CommandResults(
            outputs_prefix='VirusTotalTest',
            outputs_key_field='',
            outputs=response,
            raw_response=response
        )

        return command_results


    def domain_report_command(client, args):
        domain = str(args.get('domain', ''))

        response = client.domain_report_request(domain)
        command_results = CommandResults(
            outputs_prefix='VirusTotalTest',
            outputs_key_field='',
            outputs=response,
            raw_response=response
        )

        return command_results


    def file_scan_command(client, args):

        response = client.file_scan_request()
        command_results = CommandResults(
            outputs_prefix='VirusTotalTest',
            outputs_key_field='',
            outputs=response,
            raw_response=response
        )

        return command_results


    def file_download_command(client, args):
        hash = str(args.get('hash', ''))

        response = client.file_download_request(hash)
        command_results = CommandResults(
            outputs_prefix='VirusTotalTest',
            outputs_key_field='',
            outputs=response,
            raw_response=response
        )

        return command_results


    def test_module(client):
        # Test functions here
        demisto.results('ok')


    def main():

        params = demisto.params()
        args = demisto.args()
        url = params.get('url')
        verify_certificate = not params.get('insecure', False)
        proxy = params.get('proxy', False)
        headers = {}
        headers['Authorization'] = f'{params["api_key"]}'

        command = demisto.command()
        LOG(f'Command being called is {command}')

        try:
            requests.packages.urllib3.disable_warnings()
            client = Client(urljoin(url, ""), verify_certificate,
                            proxy, headers=headers, auth=None)
            commands = {
                'vt-test-url-report': url_report_command,
                'vt-test-domain-report': domain_report_command,
                'vt-test-file-scan': file_scan_command,
                'vt-test-file-download': file_download_command,
            }

            if command == 'test-module':
                test_module(client)
            else:
                return_results(commands[command](client, args))

        except Exception as e:
            return_error(str(e))


    if __name__ in ['__main__', 'builtin', 'builtins']:
        main()
  feed: false
  longRunning: false
  longRunningPort: false
  runonce: false
  subtype: python3
  type: python
