category: Analytics & SIEM
commonfields:
  id: Securonix1
  version: -1
configuration:
- display: Host (Overrides the default hostname, https://{tenant}.net/Snypr)
  name: host
  required: false
  type: 0
- display: Tenant
  name: tenant
  required: true
  type: 0
- display: Username
  name: username
  required: true
  type: 0
- display: Password
  name: password
  required: true
  type: 4
- display: Fetch incidents
  name: isFetch
  required: false
  type: 8
- defaultvalue: open
  display: Incidents to fetch
  name: incident_status
  options:
  - All
  - open
  - completed
  required: false
  type: 15
- display: Incident type
  name: incidentType
  required: false
  type: 13
- defaultvalue: 1 hour
  display: First fetch time range (<number> <time unit>, e.g., 1 hour, 30 minutes)
  name: fetch_time
  required: false
  type: 0
- display: Trust any certificate (not secure)
  name: unsecure
  required: false
  type: 8
- display: Use system proxy settings
  name: proxy
  required: false
  type: 8
description: Use the Securonix integration to manage incidents and watchlists.
display: Securonix1
name: Securonix1
script:
  commands:
  - deprecated: false
    description: Gets a list of all available workflows.
    execution: false
    name: securonix-list-workflows
    outputs:
    - contextPath: Securonix.Workflows.Workflow
      description: Workflow name.
      type: String
    - contextPath: Securonix.Workflows.Type
      description: Workflow type.
      type: String
    - contextPath: Securonix.Workflows.Value
      description: Workflow value.
      type: String
  - arguments:
    - default: false
      description: Workflow name.
      isArray: false
      name: workflow
      required: true
      secret: false
    deprecated: false
    description: Gets the default assignee for the specified workflow.
    execution: false
    name: securonix-get-default-assignee-for-workflow
    outputs:
    - contextPath: Securonix.Workflows.Workflow
      description: Workflow name.
      type: String
    - contextPath: Securonix.Workflows.Type
      description: Workflow type.
      type: String
    - contextPath: Securonix.Workflows.Value
      description: Workflow value.
      type: String
  - deprecated: false
    description: Gets a list available threat actions.
    execution: false
    name: securonix-list-possible-threat-actions
    outputs:
    - contextPath: Securonix.ThreatActions
      description: A list of threat actions.
      type: String
  - deprecated: false
    description: Gets a list of all policies.
    execution: false
    name: securonix-list-policies
    outputs:
    - contextPath: Securonix.Policies.CreatedBy
      description: Creator of the policy.
      type: String
    - contextPath: Securonix.Policies.CreatedOn
      description: Policy created date.
      type: Date
    - contextPath: Securonix.Policies.Criticality
      description: Policy criticality.
      type: String
    - contextPath: Securonix.Policies.Description
      description: Policy description.
      type: String
    - contextPath: Securonix.Policies.Hql
      description: Policy Hibernate Query Language.
      type: String
    - contextPath: Securonix.Policies.ID
      description: Policy ID.
      type: String
    - contextPath: Securonix.Policies.Name
      description: Policy name.
      type: String
  - deprecated: false
    description: Gets a list of resource groups.
    execution: false
    name: securonix-list-resource-groups
    outputs:
    - contextPath: Securonix.ResourceGroups.Name
      description: Resource group name.
      type: String
    - contextPath: Securonix.ResourceGroups.Type
      description: Resource group type.
      type: String
  - deprecated: false
    description: Gets a list of users.
    execution: false
    name: securonix-list-users
    outputs:
    - contextPath: Securonix.Users.LastName
      description: User last name.
      type: String
    - contextPath: Securonix.Users.SkipEncryption
      description: Whether user encryption was skipped.
      type: String
    - contextPath: Securonix.Users.Riskscore
      description: User risk score.
      type: String
    - contextPath: Securonix.Users.EmployeeID
      description: User Employee ID.
      type: String
    - contextPath: Securonix.Users.Masked
      description: Whether the user is masked.
      type: String
    - contextPath: Securonix.Users.Division
      description: User division.
      type: String
    - contextPath: Securonix.Users.Criticality
      description: User criticality.
      type: String
    - contextPath: Securonix.Users.Status
      description: User status.
      type: String
    - contextPath: Securonix.Users.Department
      description: User department.
      type: String
    - contextPath: Securonix.Users.Title
      description: User title.
      type: String
    - contextPath: Securonix.Users.FirstName
      description: User first name.
      type: String
    - contextPath: Securonix.Users.Email
      description: User email address.
      type: String
  - arguments:
    - default: false
      description: Start date/time for which to retrieve activity data (in the format
        MM/dd/yyyy HH:mm:ss).
      isArray: false
      name: from
      required: true
      secret: false
    - default: false
      description: End date/time for which to retrieve activity data (in the format
        MM/dd/yyyy HH:mm:ss).
      isArray: false
      name: to
      required: true
      secret: false
    - default: false
      description: Free-text query. For example, query=“resourcegroupname=WindowsSnare
        and policyname=Possible Privilege Escalation - Self Escalation”.
      isArray: false
      name: query
      required: false
      secret: false
    deprecated: false
    description: Gets a list of activity data for the specified resource group.
    execution: false
    name: securonix-list-activity-data
    outputs:
    - contextPath: Securonix.ActivityData.Accountname
      description: Account name.
      type: String
    - contextPath: Securonix.ActivityData.Agentfilename
      description: Agent file name.
      type: String
    - contextPath: Securonix.ActivityData.Categorybehavior
      description: Category behavior.
      type: String
    - contextPath: Securonix.ActivityData.Categoryobject
      description: Category object.
      type: String
    - contextPath: Securonix.ActivityData.Categoryseverity
      description: Category severity.
      type: String
    - contextPath: Securonix.ActivityData.Collectionmethod
      description: Collection method.
      type: String
    - contextPath: Securonix.ActivityData.Collectiontimestamp
      description: Collection timestamp.
      type: String
    - contextPath: Securonix.ActivityData.Destinationprocessname
      description: Destination process name.
      type: String
    - contextPath: Securonix.ActivityData.Destinationusername
      description: Destination username.
      type: String
    - contextPath: Securonix.ActivityData.Deviceaddress
      description: Device address.
      type: String
    - contextPath: Securonix.ActivityData.Deviceexternalid
      description: Device external ID.
      type: String
    - contextPath: Securonix.ActivityData.Devicehostname
      description: Device hostname.
      type: String
    - contextPath: Securonix.ActivityData.EventID
      description: Event ID.
      type: String
    - contextPath: Securonix.ActivityData.Eventoutcome
      description: Event outcome.
      type: String
    - contextPath: Securonix.ActivityData.Eventtime
      description: Time the event occurred.
      type: String
    - contextPath: Securonix.ActivityData.Filepath
      description: File path.
      type: String
    - contextPath: Securonix.ActivityData.Ingestionnodeid
      description: Ingestion node ID.
      type: String
    - contextPath: Securonix.ActivityData.JobID
      description: Job ID.
      type: String
    - contextPath: Securonix.ActivityData.Jobstarttime
      description: Job start time.
      type: String
    - contextPath: Securonix.ActivityData.Message
      description: Message.
      type: String
    - contextPath: Securonix.ActivityData.Publishedtime
      description: Published time.
      type: String
    - contextPath: Securonix.ActivityData.Receivedtime
      description: Received time.
      type: String
    - contextPath: Securonix.ActivityData.Resourcename
      description: Resource name.
      type: String
    - contextPath: Securonix.ActivityData.ResourceGroupCategory
      description: Resource group category.
      type: String
    - contextPath: Securonix.ActivityData.ResourceGroupFunctionality
      description: Resource group functionality.
      type: String
    - contextPath: Securonix.ActivityData.ResourceGroupID
      description: Resource group ID.
      type: String
    - contextPath: Securonix.ActivityData.ResourceGroupName
      description: Resource group name.
      type: String
    - contextPath: Securonix.ActivityData.ResourceGroupTypeID
      description: Resource group resource type ID.
      type: String
    - contextPath: Securonix.ActivityData.ResourceGroupVendor
      description: Resource group vendor.
      type: String
    - contextPath: Securonix.ActivityData.Sourcehostname
      description: Source hostname.
      type: String
    - contextPath: Securonix.ActivityData.Sourceusername
      description: Source username.
      type: String
    - contextPath: Securonix.ActivityData.TenantID
      description: Tenant ID.
      type: String
    - contextPath: Securonix.ActivityData.Tenantname
      description: Tenant name.
      type: String
    - contextPath: Securonix.ActivityData.Timeline
      description: Time when the activity occurred, in Epoch time.
      type: String
  - arguments:
    - default: false
      description: Start date/time for which to retrieve activity data (in the format
        MM/dd/yyyy HH:mm:ss).
      isArray: false
      name: from
      required: true
      secret: false
    - default: false
      description: End date/time for which to retrieve activity data (in the format
        MM/dd/yyyy HH:mm:ss).
      isArray: false
      name: to
      required: true
      secret: false
    - default: false
      description: Free-text query. For example, query="resourcegroupname=WindowsSnare
        and policyname=Possible Privilege Escalation - Self Escalation"."
      isArray: false
      name: query
      required: false
      secret: false
    deprecated: false
    description: Gets a list activity data for an account name.
    execution: false
    name: securonix-list-violation-data
    outputs:
    - contextPath: Securonix.ViolationData.Accountname
      description: Account name.
      type: String
    - contextPath: Securonix.ViolationData.Agentfilename
      description: Agent file name.
      type: String
    - contextPath: Securonix.ViolationData.Baseeventid
      description: Base event ID.
      type: String
    - contextPath: Securonix.ViolationData.Categorybehavior
      description: Category behavior.
      type: String
    - contextPath: Securonix.ViolationData.Category
      description: Violation category.
      type: String
    - contextPath: Securonix.ViolationData.Categoryobject
      description: Category object.
      type: String
    - contextPath: Securonix.ViolationData.Categoryseverity
      description: Category severity.
      type: String
    - contextPath: Securonix.ViolationData.Destinationaddress
      description: Destination address.
      type: String
    - contextPath: Securonix.ViolationData.Destinationntdomain
      description: Destination nt domain.
      type: String
    - contextPath: Securonix.ViolationData.Destinationuserid
      description: Destination user ID.
      type: String
    - contextPath: Securonix.ViolationData.Gestinationusername
      description: Destination username.
      type: String
    - contextPath: Securonix.ViolationData.Deviceaddress
      description: Device address.
      type: String
    - contextPath: Securonix.ViolationData.Deviceeventcategory
      description: Device event category.
      type: String
    - contextPath: Securonix.ViolationData.Deviceexternalid
      description: Device external ID.
      type: String
    - contextPath: Securonix.ViolationData.Devicehostname
      description: Device hostname.
      type: String
    - contextPath: Securonix.ViolationData.EventID
      description: Event ID.
      type: String
    - contextPath: Securonix.ViolationData.Eventoutcome
      description: Event outcome.
      type: String
    - contextPath: Securonix.ViolationData.Eventtime
      description: Time the event occurred.
      type: String
    - contextPath: Securonix.ViolationData.Generationtime
      description: Time that the violation was generated in Securonix.
      type: String
    - contextPath: Securonix.ViolationData.Invalid
      description: Whether the violation is valid.
      type: String
    - contextPath: Securonix.ViolationData.JobID
      description: Job ID.
      type: String
    - contextPath: Securonix.ViolationData.Jobstarttime
      description: Job start time.
      type: String
    - contextPath: Securonix.ViolationData.Policyname
      description: Policy name.
      type: String
    - contextPath: Securonix.ViolationData.Resourcename
      description: Resource name.
      type: String
    - contextPath: Securonix.ViolationData.ResourceGroupID
      description: Resource group ID.
      type: String
    - contextPath: Securonix.ViolationData.ResourceGroupName
      description: Resource group name.
      type: String
    - contextPath: Securonix.ViolationData.Riskscore
      description: Risk score.
      type: String
    - contextPath: Securonix.ViolationData.Riskthreatname
      description: Risk threat name.
      type: String
    - contextPath: Securonix.ViolationData.Sessionid
      description: Session ID.
      type: String
    - contextPath: Securonix.ViolationData.Sourcehostname
      description: Source hostname.
      type: String
    - contextPath: Securonix.ViolationData.Sourcentdomain
      description: Source nt domain.
      type: String
    - contextPath: Securonix.ViolationData.Sourceuserid
      description: Source user ID.
      type: String
    - contextPath: Securonix.ViolationData.Sourceusername
      description: Source username.
      type: String
    - contextPath: Securonix.ViolationData.Sourceuserprivileges
      description: Source user privileges.
      type: String
    - contextPath: Securonix.ViolationData.TenantID
      description: Tenant ID.
      type: String
    - contextPath: Securonix.ViolationData.Tenantname
      description: Tenant name.
      type: String
    - contextPath: Securonix.ViolationData.Timeline
      description: Time when the activity occurred, in Epoch time.
      type: String
    - contextPath: Securonix.ViolationData.Createdate
      description: Create date.
      type: String
    - contextPath: Securonix.ViolationData.Criticality
      description: Violation criticality.
      type: String
    - contextPath: Securonix.ViolationData.DataSourceID
      description: Data source ID.
      type: String
    - contextPath: Securonix.ViolationData.Department
      description: Department affected by the violation.
      type: String
    - contextPath: Securonix.ViolationData.EmployeeID
      description: Employee ID.
      type: String
    - contextPath: Securonix.ViolationData.Encrypted
      description: Whether the violation is encrypted.
      type: String
    - contextPath: Securonix.ViolationData.Firstname
      description: First name of the user that violated the policy.
      type: String
    - contextPath: Securonix.ViolationData.Fullname
      description: Full name of the user that violated the policy.
      type: String
    - contextPath: Securonix.ViolationData.ID
      description: ID of the user that violated the policy.
      type: String
    - contextPath: Securonix.ViolationData.LanID
      description: LAN ID associated with the policy violation.
      type: String
    - contextPath: Securonix.ViolationData.Lastname
      description: Last name of the user that violated the policy.
      type: String
    - contextPath: Securonix.ViolationData.Lastsynctime
      description: Last sync time, in Epoch time.
      type: String
    - contextPath: Securonix.ViolationData.Masked
      description: Whether the violation is masked.
      type: String
    - contextPath: Securonix.ViolationData.Mergeuniquecode
      description: Merge unique code.
      type: String
    - contextPath: Securonix.ViolationData.Riskscore
      description: Risk score.
      type: String
    - contextPath: Securonix.ViolationData.Skipencryption
      description: Skip encryption.
      type: String
    - contextPath: Securonix.ViolationData.Status
      description: Status of the policy violation.
      type: String
    - contextPath: Securonix.ViolationData.Timezoneoffset
      description: Timezone offset.
      type: String
    - contextPath: Securonix.ViolationData.Title
      description: Title.
      type: String
    - contextPath: Securonix.ViolationData.Uniquecode
      description: Unique code.
      type: String
    - contextPath: Securonix.ViolationData.UserID
      description: Last sync time, in Epoch time.
      type: String
    - contextPath: Securonix.ViolationData.Workemail
      description: Work email address of the user that violated the policy.
      type: String
    - contextPath: Securonix.ViolationData.Violator
      description: Violator.
      type: String
  - arguments:
    - default: false
      description: ' Start time range for which to return incidents (<number> <time
        unit>, e.g., 1 hour, 30 minutes)'
      isArray: false
      name: from
      required: true
      secret: false
    - default: false
      description: End date/time for which to retrieve incidents (in the format MM/dd/yyyy
        HH:mm:ss) Default is current time.
      isArray: false
      name: to
      required: false
      secret: false
    - default: false
      description: The incident type. Can be "updated", "opened", or "closed". Supports
        multiple selections.
      isArray: false
      name: incident_types
      required: false
      secret: false
    deprecated: false
    description: Gets a list of incidents.
    execution: false
    name: securonix-list-incidents
    outputs:
    - contextPath: Securonix.Incidents.ViolatorID
      description: Incident Violator ID.
      type: String
    - contextPath: Securonix.Incidents.Entity
      description: Incident entity.
      type: String
    - contextPath: Securonix.Incidents.Riskscore
      description: Incident risk score.
      type: Number
    - contextPath: Securonix.Incidents.Priority
      description: Incident priority.
      type: String
    - contextPath: Securonix.Incidents.Reason
      description: Reason for the incident. Usually includes policy name and/or possible
        threat name.
      type: String
    - contextPath: Securonix.Incidents.IncidentStatus
      description: Incident status.
      type: String
    - contextPath: Securonix.Incidents.WorkflowName
      description: Incident workflow name.
      type: String
    - contextPath: Securonix.Incidents.Watchlisted
      description: Whether the incident is in a watchlist.
      type: Boolean
    - contextPath: Securonix.Incidents.IncidentType
      description: Incident type.
      type: String
    - contextPath: Securonix.Incidents.IncidentID
      description: Incident ID.
      type: String
    - contextPath: Securonix.Incidents.LastUpdateDate
      description: Last update date of the incident in Epoch time.
      type: Number
    - contextPath: Securonix.Incidents.Url
      description: URL that links to the incident on Securonix.
      type: String
    - contextPath: Securonix.Incidents.ViolatorText
      description: Incident violator text.
      type: String
    - contextPath: Securonix.Incidents.AssignedUser
      description: User assigned to the incident.
      type: String
    - contextPath: Securonix.Incidents.IsWhitelisted
      description: Whether the incident is whitelisted.
      type: Boolean
  - arguments:
    - default: false
      description: Incident ID.
      isArray: false
      name: incident_id
      required: true
      secret: false
    deprecated: false
    description: Gets details of the specified incident.
    execution: false
    name: securonix-get-incident
    outputs:
    - contextPath: Securonix.Incidents.ViolatorID
      description: Incident violator ID.
      type: String
    - contextPath: Securonix.Incidents.Entity
      description: Incident entity.
      type: String
    - contextPath: Securonix.Incidents.Riskscore
      description: Incident risk score.
      type: Number
    - contextPath: Securonix.Incidents.Priority
      description: Incident priority.
      type: String
    - contextPath: Securonix.Incidents.Reason
      description: Reason for the incident. Usually includes policy name and/or possible
        threat name.
      type: String
    - contextPath: Securonix.Incidents.IncidentStatus
      description: Incident status.
      type: String
    - contextPath: Securonix.Incidents.WorkflowName
      description: Incident workflow name.
      type: String
    - contextPath: Securonix.Incidents.Watchlisted
      description: Whether the incident is in a watchlist.
      type: Boolean
    - contextPath: Securonix.Incidents.IncidentType
      description: Incident type.
      type: String
    - contextPath: Securonix.Incidents.IncidentID
      description: Incident ID.
      type: String
    - contextPath: Securonix.Incidents.LastUpdateDate
      description: The time when the incident was last updated, in Epoch time.
      type: Number
    - contextPath: Securonix.Incidents.Url
      description: URL that links to the incident on Securonix.
      type: String
    - contextPath: Securonix.Incidents.ViolatorText
      description: Incident violator text.
      type: String
    - contextPath: Securonix.Incidents.AssignedUser
      description: User assigned to the incident.
      type: String
    - contextPath: Securonix.Incidents.IsWhitelisted
      description: Whether the incident is whitelisted.
      type: Boolean
  - arguments:
    - default: false
      description: Incident ID.
      isArray: false
      name: incident_id
      required: true
      secret: false
    deprecated: false
    description: Gets the status of the specified incident.
    execution: false
    name: securonix-get-incident-status
    outputs:
    - contextPath: Securonix.Incidents.IncidentStatus
      description: Incident status.
      type: String
    - contextPath: Securonix.Incidents.IncidentID
      description: Incident ID.
      type: String
  - arguments:
    - default: false
      description: Incident ID.
      isArray: false
      name: incident_id
      required: true
      secret: false
    deprecated: false
    description: Gets the workflow of the specified incident.
    execution: false
    name: securonix-get-incident-workflow
    outputs:
    - contextPath: Securonix.Incidents.Workflow
      description: Incident workflow.
      type: String
    - contextPath: Securonix.Incidents.IncidentID
      description: Incident ID.
      type: String
  - arguments:
    - default: false
      description: Incident ID.
      isArray: false
      name: incident_id
      required: true
      secret: false
    deprecated: false
    description: Gets a list of available actions for the specified incident.
    execution: false
    name: securonix-get-incident-available-actions
  - arguments:
    - default: false
      description: Incident ID.
      isArray: false
      name: incident_id
      required: true
      secret: false
    - default: false
      description: 'Action to perform on the incident. You can see them using securonix-get-incident-available-actions.
        e.g: "CLAIM", "ASSIGN TO SECOPS", "ASSIGN TO ANALYST", "RELEASE", or "COMMENT".'
      isArray: false
      name: action
      predefined:
      - ''
      required: true
      secret: false
    deprecated: false
    description: Performs an action on the specified incident.
    execution: false
    name: securonix-perform-action-on-incident
  - arguments:
    - default: false
      description: Incident ID.
      isArray: false
      name: incident_id
      required: true
      secret: false
    - default: false
      description: Comment to add to the incident.
      isArray: false
      name: comment
      required: true
      secret: false
    deprecated: false
    description: Adds a comment to the specified incident.
    execution: true
    name: securonix-add-comment-to-incident
  - deprecated: false
    description: Gets a list of watchlists.
    execution: false
    name: securonix-list-watchlists
    outputs:
    - contextPath: Securonix.WatchlistsNames
      description: Watchlist names.
      type: String
  - arguments:
    - default: false
      description: Watchlist name.
      isArray: false
      name: watchlist_name
      required: true
      secret: false
    deprecated: false
    description: Gets information for the specified watchlist.
    execution: false
    name: securonix-get-watchlist
    outputs:
    - contextPath: Securonix.Watchlists.TenantID
      description: Watchlist tenant ID.
      type: String
    - contextPath: Securonix.Watchlists.Tenantname
      description: Watchlist tenant name.
      type: String
    - contextPath: Securonix.Watchlists.Type
      description: Watchlist type.
      type: String
    - contextPath: Securonix.Watchlists.Watchlistname
      description: Watchlist name.
      type: String
    - contextPath: Securonix.Watchlists.Events.ExpiryDate
      description: Expiration date of the entity in the watchlist, in Epoch time.
      type: String
    - contextPath: Securonix.Watchlists.Events.Workemail
      description: Work email address of the entity in the watchlist.
      type: String
    - contextPath: Securonix.Watchlists.Events.Fullname
      description: Full name of the entity in the watchlist.
      type: String
    - contextPath: Securonix.Watchlists.Events.Reason
      description: Reason that the entity is in the watchlist.
      type: String
    - contextPath: Securonix.Watchlists.Events.LanID
      description: Lan ID of the entity in the watchlist.
      type: String
    - contextPath: Securonix.Watchlists.Events.Lastname
      description: Last name of the entity in the watchlist.
      type: String
    - contextPath: Securonix.Watchlists.Events.EntityName
      description: Entity name of the entity in the watchlist.
      type: String
    - contextPath: Securonix.Watchlists.Events.Title
      description: Title of the entity in the watchlist.
      type: String
    - contextPath: Securonix.Watchlists.Events.Firstname
      description: First name of the entity in the watchlist.
      type: String
    - contextPath: Securonix.Watchlists.Events.EmployeeID
      description: Employee ID of the entity in the watchlist.
      type: String
    - contextPath: Securonix.Watchlists.Events.Masked
      description: Whether the entity in the watchlist is masked.
      type: String
    - contextPath: Securonix.Watchlists.Events.Division
      description: Division of the entity in the watchlist.
      type: String
    - contextPath: Securonix.Watchlists.Events.Departmant
      description: Department of the entity in the watchlist.
      type: String
    - contextPath: Securonix.Watchlists.Events.Status
      description: Status of the entity in the watchlist.
      type: String
  - arguments:
    - default: false
      description: The name of the watchlist.
      isArray: false
      name: watchlist_name
      required: true
      secret: false
    deprecated: false
    description: Creates a watchlist in Securonix.
    execution: false
    name: securonix-create-watchlist
  - arguments:
    - default: false
      description: 'The name of the entity to check. For example: 1002.'
      isArray: false
      name: entity_name
      required: true
      secret: false
    - default: false
      description: The name of the watchlist in which to check the entity.
      isArray: false
      name: watchlist_name
      required: true
      secret: false
    deprecated: false
    description: Checks if the specified entity is in a watchlist.
    execution: false
    name: securonix-check-entity-in-watchlist
    outputs:
    - contextPath: Securonix.EntityInWatchlist.Watchlistnames
      description: The names of the watchlists in which the entity appears.
      type: String
    - contextPath: Securonix.EntityInWatchlist.EntityID
      description: The entity ID.
      type: String
  - arguments:
    - default: false
      description: The name of the watchlist to which to add the entity.
      isArray: false
      name: watchlist_name
      required: true
      secret: false
    - auto: PREDEFINED
      default: false
      description: The entity type. Can be "Users", "Activityaccount", "RGActivityaccount",
        "Resources", or "Activityip".
      isArray: false
      name: entity_type
      predefined:
      - Users
      - Activityaccount
      - RGActivityaccount
      - Resources
      - Activityip
      required: true
      secret: false
    - default: false
      description: 'The name of the entity to add to the watchlist. For example: 1022.'
      isArray: false
      name: entity_name
      required: true
      secret: false
    - default: false
      defaultValue: '30'
      description: The number of days after which the entity will be removed from
        the watchlist. The default value is "30".
      isArray: false
      name: expiry_days
      required: false
      secret: false
    deprecated: false
    description: Adds an entity to a watchlist.
    execution: false
    name: securonix-add-entity-to-watchlist
  - arguments:
    - default: false
      description: 'The violation name or policy name. For example: "Uploads to personal
        Websites".'
      isArray: false
      name: violation_name
      required: true
      secret: false
    - default: false
      description: 'The resource group name. For example: "BLUECOAT", "Palo Alto Firewall".'
      isArray: false
      name: resource_group
      required: true
      secret: false
    - auto: PREDEFINED
      default: false
      description: The entity type. Can be "Users", "Activityaccount", "RGActivityaccount",
        "Resources", or "Activityip".
      isArray: false
      name: entity_type
      predefined:
      - Users
      - Activityaccount
      - RGActivityaccount
      - Resources
      - Activityip
      required: true
      secret: false
    - default: false
      description: The entity name associated with the violation. Can be "LanID" or
        "Workemail". For more information, see the Securonix documentation.
      isArray: false
      name: entity_name
      required: true
      secret: false
    - auto: PREDEFINED
      default: false
      description: The action name. Can be "Mark as concern and create incident",
        "Non-Concern", or "Mark in progress (still investigating)".
      isArray: false
      name: action_name
      predefined:
      - Mark as concern and create incident
      - Non-Concern
      - Mark in progress (still investigating)
      required: true
      secret: false
    - default: false
      description: 'The resource name. For example: "BLUECOAT", "Palo Alto Firewall".'
      isArray: false
      name: resource_name
      required: true
      secret: false
    - auto: PREDEFINED
      default: false
      description: The incident severity (criticality) for the new incident. Can be
        "Low", "High", or "Critical".
      isArray: false
      name: criticality
      predefined:
      - Low
      - High
      - Critical
      required: false
      secret: false
    - default: false
      description: A comment for the new incident.
      isArray: false
      name: comment
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      description: The workflow name. This argument is optional, but required when
        the action_name argument is set to "Mark as concern and create incident".
        Can be "SOCTeamReview", "ActivityOutlierWorkflow", or "AccessCertificationWorkflow".
      isArray: false
      name: workflow
      predefined:
      - SOCTeamReview
      - ActivityOutlierWorkflow
      - AccessCertificationWorkflow
      required: false
      secret: false
    deprecated: false
    description: Creates an incident. For more information about the required arguments,
      see the Securonix documentation.
    execution: false
    name: securonix-create-incident
    outputs:
    - contextPath: Securonix.Incidents.ViolatorID
      description: The ID of the incident violator.
      type: String
    - contextPath: Securonix.Incidents.Entity
      description: The incident entity.
      type: String
    - contextPath: Securonix.Incidents.Riskscore
      description: The incident risk score.
      type: Number
    - contextPath: Securonix.Incidents.Priority
      description: The incident priority.
      type: String
    - contextPath: Securonix.Incidents.Reason
      description: The reason that the incident was created. Usually includes the
        policy name and/or possible threat name.
      type: String
    - contextPath: Securonix.Incidents.IncidentStatus
      description: The incident status.
      type: String
    - contextPath: Securonix.Incidents.WorkflowName
      description: The incident workflow name.
      type: String
    - contextPath: Securonix.Incidents.Watchlisted
      description: Whether the incident is in a watchlist.
      type: Boolean
    - contextPath: Securonix.Incidents.IncidentType
      description: The incident type.
      type: String
    - contextPath: Securonix.Incidents.IncidentID
      description: The incident ID.
      type: String
    - contextPath: Securonix.Incidents.LastUpdateDate
      description: The time when the incident was last updated, in Epoch time.
      type: Number
    - contextPath: Securonix.Incidents.Url
      description: The URL that links to the incident on Securonix.
      type: String
    - contextPath: Securonix.Incidents.ViolatorText
      description: Text of the incident violator.
      type: String
    - contextPath: Securonix.Incidents.AssignedUser
      description: The user assigned to the incident.
      type: String
    - contextPath: Securonix.Incidents.IsWhitelisted
      description: Whether the incident is whitelisted.
      type: Boolean
  dockerimage: demisto/python3:3.7.5.4328
  feed: false
  isfetch: true
  longRunning: false
  longRunningPort: false
  runonce: false
  script: |-
    from datetime import datetime
    from typing import Dict, Tuple, Optional, List, Callable, Any

    import urllib3


    # Disable insecure warnings
    urllib3.disable_warnings()


    def reformat_resource_groups_outputs(text: str) -> str:
        """rg_*text -> ResourceGroupText
        Args:
            text: the text to transform
        Returns:
            A Camel Cased string.
        """
        suffix = text[3:]
        if suffix == 'id':
            suffix = 'ID'
        elif suffix == 'resourcetypeid':
            suffix = 'TypeID'
        else:
            suffix = suffix.title()
        return f'ResourceGroup{suffix}'


    def reformat_outputs(text: str) -> str:
        """camelCase -> Camel Case, id -> ID
        Args:
            text: the text to transform
        Returns:
            A Demisto output standard string
        """
        if text.startswith('rg_'):
            return reformat_resource_groups_outputs(text)
        if text == 'id':
            return 'ID'
        if text in ['lanid', 'u_lanid']:
            return 'LanID'
        if text == 'jobId':
            return 'JobID'
        if text == 'eventId':
            return 'EventID'
        if text == 'entityId':
            return 'EntityID'
        if text in ['tenantId', 'tenantid']:
            return 'TenantID'
        if text == 'incidentId':
            return 'IncidentID'
        if text == 'Datasourceid':
            return 'DataSourceID'
        if text in ['employeeId', 'employeeid', 'u_employeeid']:
            return 'EmployeeID'
        if text == 'violatorId':
            return 'ViolatorID'

        if text.startswith('U_') or text.startswith('u_'):
            text = text[2:]
        return ''.join(' ' + char if char.isupper() else char.strip() for char in text).strip().title()


    def parse_data_arr(data_arr: Any, fields_to_drop: list = [], fields_to_include: list = []):
        """Parse data as received from Securonix into Demisto's conventions
        Args:
            data_arr: a dictionary containing the data
            fields_to_drop: Fields to drop from the array of the data
            fields_to_include: Fields to include from the array of the data
        Returns:
            A Camel Cased dictionary with the relevant fields.
            readable: for the human readable
            outputs: for the entry context
        """
        if isinstance(data_arr, list):
            readable_arr, outputs_arr = [], []
            for data in data_arr:
                readable = {reformat_outputs(i): j for i, j in data.items() if i not in fields_to_drop}
                if fields_to_include:
                    readable = {i: j for i, j in readable.items() if i in fields_to_include}
                readable_arr.append(readable)
                outputs_arr.append({k.replace(' ', ''): v for k, v in readable.copy().items()})
            return readable_arr, outputs_arr

        readable = {reformat_outputs(i): j for i, j in data_arr.items() if i not in fields_to_drop}
        if fields_to_include:
            readable = {i: j for i, j in readable.items() if i in fields_to_include}
        outputs = {k.replace(' ', ''): v for k, v in readable.copy().items()}

        return readable, outputs


    def incident_priority_to_dbot_score(priority_str: str):
        """Converts an priority string to DBot score representation
            alert severity. Can be one of:
            Low    ->  1
            Medium ->  2
            High   ->  3

        Args:
            priority_str: String representation of proirity.

        Returns:
            Dbot representation of severity
        """
        priority = priority_str.lower()
        if priority == 'low':
            return 1
        if priority == 'medium':
            return 2
        if priority == 'high':
            return 3
        demisto.info(f'Securonix incident priority: {priority} is not known. Setting as unknown(DBotScore of 0).')
        return 0


    class Client(BaseClient):
        """
        Client to use in the Securonix integration. Overrides BaseClient
        """
        def __init__(self, tenant: str, server_url: str, username: str, password: str, verify: bool,
                     proxy: bool):
            super().__init__(base_url=server_url, verify=verify)
            self._username = username
            self._password = password
            self._tenant = tenant
            self._proxies = handle_proxy() if proxy else None
            self._token = self._generate_token()

        def http_request(self, method, url_suffix, headers=None, params=None, response_type: str = 'json'):
            """
            Generic request to Securonix
            """
            full_url = urljoin(self._base_url, url_suffix)
            try:
                result = requests.request(
                    method,
                    full_url,
                    params=params,
                    headers=headers,
                    verify=self._verify,
                    proxies=self._proxies
                )
                if not result.ok:
                    raise ValueError(f'Error in API call to Securonix {result.status_code}. Reason: {result.text}')
                try:
                    if response_type != 'json':
                        return result.text
                    return result.json()
                except Exception:
                    raise ValueError(
                        f'Failed to parse http response to JSON format. Original response body: \n{result.text}')

            except requests.exceptions.ConnectTimeout as exception:
                err_msg = 'Connection Timeout Error - potential reasons might be that the Server URL parameter' \
                          ' is incorrect or that the Server is not accessible from your host.'
                raise Exception(f'{err_msg}\n{exception}')

            except requests.exceptions.SSLError as exception:
                err_msg = 'SSL Certificate Verification Failed - try selecting \'Trust any certificate\' checkbox in' \
                          ' the integration configuration.'
                raise Exception(f'{err_msg}\n{exception}')

            except requests.exceptions.ProxyError as exception:
                err_msg = 'Proxy Error - if the \'Use system proxy\' checkbox in the integration configuration is' \
                          ' selected, try clearing the checkbox.'
                raise Exception(f'{err_msg}\n{exception}')

            except requests.exceptions.ConnectionError as exception:
                error_class = str(exception.__class__)
                err_type = '<' + error_class[error_class.find('\'') + 1: error_class.rfind('\'')] + '>'
                err_msg = f'Error Type: {err_type}\n' \
                          f'Error Number: [{exception.errno}]\n' \
                          f'Message: {exception.strerror}\n' \
                          f'Verify that the tenant parameter is correct' \
                          f'and that you have access to the server from your host.'
                raise Exception(f'{err_msg}\n{exception}')

            except Exception as exception:
                raise Exception(str(exception))

        def _generate_token(self) -> str:
            """Generate a token

            Returns:
                token valid for 1 day
            """
            headers = {
                'username': self._username,
                'password': self._password,
                'validity': "1",
                'tenant': self._tenant,
            }
            token = self.http_request('GET', '/token/generate', headers=headers, response_type='text')
            return token

        def test_module_request(self):
            """
            Testing the instance configuration by sending a GET request
            """
            self.list_workflows_request()

        def list_workflows_request(self) -> Dict:
            """List workflows.

            Returns:
                Response from API.
            """
            workflows = self.http_request('GET', '/incident/get', headers={'token': self._token},
                                          params={'type': 'workflows'})
            return workflows.get('result').get('workflows')

        def get_default_assignee_for_workflow_request(self, workflow: str) -> Dict:
            """Get default assignee for a workflow..

            Args:
                workflow: workflow name

            Returns:
                Response from API.
            """
            params = {
                'type': 'defaultAssignee',
                'workflow': workflow
            }
            default_assignee = self.http_request('GET', '/incident/get', headers={'token': self._token}, params=params)
            return default_assignee.get('result')

        def list_possible_threat_actions_request(self) -> Dict:
            """List possible threat actions.

            Returns:
                Response from API.
            """

            threat_actions = self.http_request('GET', '/incident/get', headers={'token': self._token},
                                               params={'type': 'threatActions'})
            return threat_actions.get('result')

        def list_policies_request(self) -> Dict:
            """List policies.

            Returns:
                Response from API.
            """

            policies = self.http_request('GET', '/policy/getAllPolicies', headers={'token': self._token},
                                         response_type='xml')
            return policies

        def list_resource_groups_request(self) -> Dict:
            """List resource groups.

            Returns:
                Response from API.
            """

            resource_groups = self.http_request('GET', '/list/resourceGroups', headers={'token': self._token},
                                                response_type='xml')
            return resource_groups

        def list_users_request(self) -> Dict:
            """List users.

            Returns:
                Response from API.
            """

            users = self.http_request('GET', '/list/allUsers', headers={'token': self._token},
                                      response_type='xml')
            return users

        def list_activity_data_request(self, from_: str, to_: str, query: str = None) -> Dict:
            """List activity data.

            Args:
                from_: eventtime start range in format MM/dd/yyyy HH:mm:ss.
                to_: eventtime end range in format MM/dd/yyyy HH:mm:ss.
                query: open query.

            Returns:
                Response from API.
            """
            params = {
                'query': 'index=activity',
                'eventtime_from': from_,
                'eventtime_to': to_,
                'prettyJson': True
            }
            if query:
                params['query'] = f'{params["query"]} AND {query}'
            activity_data = self.http_request('GET', '/spotter/index/search', headers={'token': self._token},
                                              params=params)
            return activity_data

        def list_violation_data_request(self, from_: str, to_: str, query: str = None) -> Dict:
            """List violation data.

            Args:
                from_: eventtime start range in format MM/dd/yyyy HH:mm:ss.
                to_: eventtime end range in format MM/dd/yyyy HH:mm:ss.
                query: open query.

            Returns:
                Response from API.
            """
            params = {
                'query': 'index=violation',
                'generationtime_from': from_,
                'generationtime_to': to_,
                'prettyJson': True
            }
            if query:
                params['query'] = f'{params["query"]} AND {query}'
            violation_data = self.http_request('GET', '/spotter/index/search', headers={'token': self._token},
                                               params=params)
            return violation_data

        def list_incidents_request(self, from_epoch: str, to_epoch: str, incident_types: str) -> Dict:
            """List all incidents by sending a GET request.

            Args:
                from_epoch: from time in epoch
                to_epoch: to time in epoch
                incident_types: incident types

            Returns:
                Response from API.
            """
            params = {
                'type': 'list',
                'from': from_epoch,
                'to': to_epoch,
                'rangeType': incident_types
            }
            incidents = self.http_request('GET', '/incident/get', headers={'token': self._token}, params=params)
            return incidents.get('result').get('data')

        def get_incident_request(self, incident_id: str) -> Dict:
            """get incident meta data by sending a GET request.

            Args:
                incident_id: incident ID.

            Returns:
                Response from API.
            """
            params = {
                'type': 'metaInfo',
                'incidentId': incident_id,
            }
            incident = self.http_request('GET', '/incident/get', headers={'token': self._token}, params=params)
            return incident.get('result').get('data')

        def get_incident_status_request(self, incident_id: str) -> Dict:
            """get incident meta data by sending a GET request.

            Args:
                incident_id: incident ID.

            Returns:
                Response from API.
            """
            params = {
                'type': 'status',
                'incidentId': incident_id,
            }
            incident = self.http_request('GET', '/incident/get', headers={'token': self._token}, params=params)
            return incident.get('result')

        def get_incident_workflow_request(self, incident_id: str) -> Dict:
            """get incident workflow by sending a GET request.

            Args:
                incident_id: incident ID.

            Returns:
                Response from API.
            """
            params = {
                'type': 'workflow',
                'incidentId': incident_id,
            }
            incident = self.http_request('GET', '/incident/get', headers={'token': self._token}, params=params)
            return incident.get('result')

        def get_incident_available_actions_request(self, incident_id: str) -> Dict:
            """get incident available actions by sending a GET request.

            Args:
                incident_id: incident ID.

            Returns:
                Response from API.
            """
            params = {
                'type': 'actions',
                'incidentId': incident_id,
            }
            incident = self.http_request('GET', '/incident/get', headers={'token': self._token}, params=params)
            return incident.get('result')

        def perform_action_on_incident_request(self, incident_id, action: str) -> Dict:
            """get incident available actions by sending a GET request.

            Args:
                incident_id: incident ID.
                action: action to perform on the incident

            Returns:
                Response from API.
            """
            params = {
                'type': 'actionInfo',
                'incidentId': incident_id,
                'actionName': action
            }
            possible_action = self.http_request('GET', '/incident/get', headers={'token': self._token}, params=params)

            if 'error' in possible_action:
                err_msg = possible_action.get('error')
                raise Exception(f'Failed to perform the action {action} on incident {incident_id}.\n'
                                f'Error from Securonix is: {err_msg}')

            incident = self.http_request('POST', '/incident/actions', headers={'token': self._token}, params=params)
            return incident.get('result')

        def add_comment_to_incident_request(self, incident_id: str, comment: str) -> Dict:
            """add comment to an incident by sending a POST request.

            Args:
                incident_id: incident ID.
                comment: action to perform on the incident

            Returns:
                Response from API.
            """
            params = {
                'incidentId': incident_id,
                'comment': comment,
                'actionName': 'comment'
            }
            incident = self.http_request('POST', '/incident/actions', headers={'token': self._token}, params=params)
            return incident.get('result')

        def create_incident_request(self, violation_name: str, resource_group: str, resource_name: str,
                                    entity_type: str, entity_name: str, action_name: str, workflow: str = None,
                                    comment: str = None, criticality: str = None) -> Dict:
            """create an incident by sending a POST request.

            Args:
                violation_name: violation or policy name.
                resource_group: resource group name.
                resource_name: resource name.
                entity_type: entity type.
                entity_name: entity name.
                action_name: action name.
                workflow: workflow name.
                comment: comment on the incident.
                criticality: criticality for the incident.

            Returns:
                Response from API.
            """
            params = {
                'violationName': violation_name,
                'datasourceName': resource_group,
                'resourceName': resource_name,
                'entityType': entity_type,
                'entityName': entity_name,
                'actionName': action_name,
            }
            if workflow:
                params['workflow'] = workflow
            if comment:
                params['comment'] = comment
            if criticality:
                params['criticality'] = criticality

            response = self.http_request('POST', '/incident/actions', headers={'token': self._token}, params=params)
            return response

        def list_watchlist_request(self):
            """list watchlists by sending a GET request.

            Returns:
                Response from API.
            """
            watchlists = self.http_request('GET', '/incident/listWatchlist', headers={'token': self._token})
            return watchlists.get('result')

        def get_watchlist_request(self, watchlist_name: str) -> Dict:
            """Get a watchlist by sending a GET request.

            Args:
                watchlist_name: watchlist name.

            Returns:
                Response from API.
            """
            params = {
                'query': f'index=watchlist AND watchlistname=\"{watchlist_name}\"',
            }
            watchlist = self.http_request('GET', '/spotter/index/search', headers={'token': self._token}, params=params)
            return watchlist

        def create_watchlist_request(self, watchlist_name: str) -> Dict:
            """Create a watchlist by sending a POST request.

            Args:
                watchlist_name: watchlist name.

            Returns:
                Response from API.
            """
            params = {
                'watchlistname': watchlist_name
            }
            watchlist = self.http_request('POST', '/incident/createWatchlist',
                                          headers={'token': self._token}, params=params, response_type='text')
            return watchlist

        def check_entity_in_watchlist_request(self, entity_name: str, watchlist_name: str) -> Dict:
            """Check if an entity is whitelisted by sending a GET request.

            Args:
                entity_name: Entity name.
                watchlist_name: Watchlist name.

            Returns:
                Response from API.
            """
            params = {
                'entityId': entity_name,
                'watchlistname': watchlist_name
            }
            response = self.http_request('GET', '/incident/checkIfWatchlisted',
                                         headers={'token': self._token}, params=params)
            return response

        def add_entity_to_watchlist_request(self, watchlist_name: str, entity_type: str, entity_name: str,
                                            expiry_days: str) -> Dict:
            """Check if an entity is whitelisted by sending a GET request.

            Args:
                watchlist_name: Watchlist name.
                entity_type: Entity type.
                entity_name: Entity name.
                expiry_days: Expiry in days.
            Returns:
                Response from API.
            """
            params = {
                'watchlistname': watchlist_name,
                'entityType': entity_type,
                'entityId': entity_name,
                'expirydays': expiry_days,
                'resourcegroupid': '-1'
            }
            watchlist = self.http_request('POST', '/incident/addToWatchlist',
                                          headers={'token': self._token}, params=params, response_type='txt')
            return watchlist


    def test_module(client: Client, *_) -> Tuple[str, Dict, Dict]:
        """
        Performs basic get request to get incident samples
        """
        client.test_module_request()
        demisto.results('ok')
        return '', {}, {}


    def list_workflows(client: Client, *_) -> Tuple[str, Dict, Dict]:
        """List all workflows.

        Args:
            client: Client object with request.
            *_:

        Returns:
            Outputs.
        """
        workflows = client.list_workflows_request()
        workflows_readable, workflows_outputs = parse_data_arr(workflows)
        human_readable = tableToMarkdown(name="Available workflows:", t=workflows_readable,
                                         headers=['Workflow', 'Type', 'Value'],
                                         removeNull=True)
        entry_context = {f'Securonix.Workflows(val.Workflow == obj.Workflow)': workflows_outputs}
        return human_readable, entry_context, workflows


    def get_default_assignee_for_workflow(client: Client, args: Dict) -> Tuple[str, Dict, Dict]:
        """Perform action on an incident.

        Args:
            client: Client object with request.
            args: Usually demisto.args()

        Returns:
            Outputs.
        """
        workflow = str(args.get('workflow'))
        default_assignee = client.get_default_assignee_for_workflow_request(workflow)
        workflow_output = {
            'Workflow': workflow,
            'Type': default_assignee.get("type"),
            'Value': default_assignee.get("value"),
        }
        entry_context = {f'Securonix.Workflows(val.Workflow === obj.Workflow)': workflow_output}
        human_readable = f'Default assignee for the workflow {workflow} is: {default_assignee.get("value")}.'
        return human_readable, entry_context, default_assignee


    def list_possible_threat_actions(client: Client, *_) -> Tuple[str, Dict, Dict]:
        """List all workflows.

        Args:
            client: Client object with request.
            *_:

        Returns:
            Outputs.
        """
        threat_actions = client.list_possible_threat_actions_request()
        human_readable = f'Possible threat actions are: {", ".join(threat_actions)}.'
        entry_context = {f'Securonix.ThreatActions': threat_actions}
        return human_readable, entry_context, threat_actions


    def list_policies(client: Client, *_) -> Tuple[str, Dict, Dict]:
        """List all policies.

        Args:
            client: Client object with request.
            *_:

        Returns:
            Outputs.
        """
        policies_xml = client.list_policies_request()
        policies_json = xml2json(policies_xml)
        policies = json.loads(policies_json)
        policies_arr = policies.get('policies').get('policy')
        policies_readable, policies_outputs = parse_data_arr(policies_arr)
        headers = ['ID', 'Name', 'Criticality', 'Created On', 'Created By', 'Description']
        human_readable = tableToMarkdown(name="Policies:", t=policies_readable, headers=headers, removeNull=True)
        entry_context = {f'Securonix.Policies(val.ID === obj.ID)': policies_outputs}

        return human_readable, entry_context, policies


    def list_resource_groups(client: Client, *_) -> Tuple[str, Dict, Dict]:
        """List all resource groups.

        Args:
            client: Client object with request.
            *_:

        Returns:
            Outputs.
        """
        resource_groups_xml = client.list_resource_groups_request()

        resource_groups_json = xml2json(resource_groups_xml)
        resource_groups = json.loads(resource_groups_json)
        resource_groups_arr = resource_groups.get('resourceGroups').get('resourceGroup')

        resource_groups_readable, resource_groups_outputs = parse_data_arr(resource_groups_arr)
        headers = ['Name', 'Type']
        human_readable = tableToMarkdown(name="Resource groups:", t=resource_groups_readable, headers=headers,
                                         removeNull=True)
        entry_context = {f'Securonix.ResourceGroups(val.Name === obj.Name)': resource_groups_outputs}

        return human_readable, entry_context, resource_groups


    def list_users(client: Client, *_) -> Tuple[str, Dict, Dict]:
        """List all users.

        Args:
            client: Client object with request.
            *_:

        Returns:
            Outputs.
        """
        users_xml = client.list_users_request()

        users_json = xml2json(users_xml)
        users = json.loads(users_json)
        users_arr = users.get('users').get('user')

        users_readable, users_outputs = parse_data_arr(users_arr)
        headers = ['Employee Id', 'First Name', 'Last Name', 'Criticality', 'Title', 'Email']
        human_readable = tableToMarkdown(name="Resource groups:", t=users_readable, headers=headers, removeNull=True)
        entry_context = {f'Securonix.Users(val.EmployeeID === obj.EmployeeID)': users_outputs}

        return human_readable, entry_context, users


    def list_activity_data(client: Client, args) -> Tuple[str, Dict, Dict]:
        """List activity data.

        Args:
            client: Client object with request.
            args: Usually demisto.args()

        Returns:
            Outputs.
        """
        from_ = args.get('from')
        to_ = args.get('to')
        query = args.get('query')
        activity_data = client.list_activity_data_request(from_, to_, query)

        if activity_data.get('error'):
            raise Exception(f'Failed to get activity data in the given time frame.\n'
                            f'Error from Securonix is: {activity_data.get("errorMessage")}')

        activity_events = activity_data.get('events')
        fields_to_include = ['Accountname', 'Agentfilename', 'Categorybehavior', 'Categoryobject', 'Categoryseverity',
                             'Collectionmethod', 'Collectiontimestamp', 'Destinationprocessname', 'Destinationusername',
                             'Deviceaddress', 'Deviceexternalid', 'Devicehostname', 'EventID', 'Eventoutcome', 'Eventtime',
                             'Filepath', 'Ingestionnodeid', 'JobID', 'Jobstarttime', 'Message', 'Publishedtime',
                             'Receivedtime', 'Resourcename', 'Rg_category', 'Rg_functionality', 'Rg_id', 'Rg_name',
                             'Rg_resourcetypeid', 'Rg_vendor', 'Sourcehostname', 'Sourceusername', 'TenantID', 'Tenantname',
                             'Timeline']
        activity_readable, activity_outputs = parse_data_arr(activity_events, fields_to_include=fields_to_include)
        headers = ['Eventid', 'Eventtime', 'Message', 'Accountname']
        human_readable = tableToMarkdown(name="Activity data:", t=activity_readable, headers=headers, removeNull=True)
        entry_context = {f'Securonix.ActivityData(val.EventID === obj.EventID)': activity_outputs}

        return human_readable, entry_context, activity_data


    def list_violation_data(client: Client, args) -> Tuple[str, Dict, Dict]:
        """List violation data.

        Args:
            client: Client object with request.
            args: Usually demisto.args()

        Returns:
            Outputs.
        """
        from_ = args.get('from')
        to_ = args.get('to')
        query = args.get('query')
        violation_data = client.list_violation_data_request(from_, to_, query)

        if violation_data.get('error'):
            raise Exception(f'Failed to get violation data in the given time frame.\n'
                            f'Error from Securonix is: {violation_data.get("errorMessage")}')
        violation_events = violation_data.get('events')
        fields_to_include = ['Accountname', 'Baseeventid', 'Category', 'Categorybehavior', 'Categoryobject',
                             'Categoryseverity', 'Destinationaddress', 'Destinationntdomain', 'Destinationuserid',
                             'Gestinationusername', 'Deviceaddress', 'Deviceeventcategory', 'Deviceexternalid',
                             'Devicehostname', 'EventID', 'Eventoutcome', 'Eventtime', 'Generationtime', 'Invalid', 'JobID',
                             'Jobstarttime', 'Message', 'Policyname', 'Resourcename', 'Rg_id', 'Rg_name', 'Riskscore',
                             'Riskthreatname', 'Sessionid', 'Sourcehostname', 'Sourcentdomain', 'Sourceuserid',
                             'Sourceusername', 'Sourceuserprivileges', 'TenantID', 'Tenantname', 'Timeline',
                             'Createdate', 'Criticality', 'Datasourceid', 'Department', 'Division',
                             'EmployeeID', 'Encrypted', 'Firstname', 'Fullname', 'ID', 'LanID', 'Lastname',
                             'Lastsynctime', 'Masked', 'Mergeuniquecode', 'Riskscore', 'Skipencryption',
                             'Status', 'Timezoneoffset', 'Title', 'Uniquecode', 'UserID', 'Workemail',
                             'Violator']
        violation_readable, violation_outputs = parse_data_arr(violation_events, fields_to_include=fields_to_include)
        headers = ['EventID', 'Eventtime', 'Message', 'Policyname', 'Accountname']
        human_readable = tableToMarkdown(name="Activity data:", t=violation_readable, headers=headers, removeNull=True)
        entry_context = {f'Securonix.ViolationData(val.Uniquecode === obj.Uniquecode)': violation_outputs}

        return human_readable, entry_context, violation_data


    def list_incidents(client: Client, args: Dict) -> Tuple[str, Dict, Dict]:
        """List incidents.

        Args:
            client: Client object with request.
            args: Usually demisto.args()

        Returns:
            Outputs.
        """
        timestamp_format = '%Y-%m-%dT%H:%M:%S.%fZ'
        from_, _ = parse_date_range(args.get('from'), utc=True)
        from_epoch = date_to_timestamp(from_, date_format=timestamp_format)
        to_ = args.get('to') if 'to_' in args else datetime.now()
        to_epoch = date_to_timestamp(to_, date_format=timestamp_format)
        incident_types = str(args.get('incident_types')) if 'incident_types' in args else 'opened'
        incidents = client.list_incidents_request(from_epoch, to_epoch, incident_types)

        total_incidents = incidents.get('totalIncidents')
        if not total_incidents or float(total_incidents) <= 0.0:
            return 'No incidents where found in this time frame.', {}, incidents

        incidents_items = incidents.get('incidentItems')
        incidents_readable, incidents_outputs = parse_data_arr(incidents_items)
        headers = ['Incident Id', 'Incident Status', 'Incident Type', 'Priority', 'Reason']
        human_readable = tableToMarkdown(name="Incidents:", t=incidents_readable,
                                         headers=headers, removeNull=True)
        entry_context = {f'Securonix.Incidents(val.IncidentID === obj.IncidentID)': incidents_outputs}
        return human_readable, entry_context, incidents


    def get_incident(client: Client, args: Dict) -> Tuple[str, Dict, Dict]:
        """Get incident.

        Args:
            client: Client object with request.
            args: Usually demisto.args()

        Returns:
            Outputs.
        """
        incident_id = str(args.get('incident_id'))
        incident = client.get_incident_request(incident_id)

        incident_items = incident.get('incidentItems')
        if not incident_items:
            raise Exception('Incident ID is not in Securonix.')
        incident_readable, incident_outputs = parse_data_arr(incident_items)
        human_readable = tableToMarkdown(name="Incident:", t=incident_readable, removeNull=True)
        entry_context = {f'Securonix.Incidents(val.IncidentID === obj.IncidentID)': incident_outputs}
        return human_readable, entry_context, incident


    def get_incident_status(client: Client, args: Dict) -> Tuple[str, Dict, Dict]:
        """Get incident.

        Args:
            client: Client object with request.
            args: Usually demisto.args()

        Returns:
            Outputs.
        """
        incident_id = str(args.get('incident_id'))
        incident = client.get_incident_status_request(incident_id)
        incident_status = incident.get('status')
        incident_outputs = {
            'IncidentID': incident_id,
            'IncidentStatus': incident_status
        }
        entry_context = {f'Securonix.Incidents(val.IncidentID === obj.IncidentID)': incident_outputs}
        return f'Incident {incident_id} status is {incident_status}.', entry_context, incident


    def get_incident_workflow(client: Client, args: Dict) -> Tuple[str, Dict, Dict]:
        """Get incident workflow.

        Args:
            client: Client object with request.
            args: Usually demisto.args()

        Returns:
            Outputs.
        """
        incident_id = str(args.get('incident_id'))

        incident = client.get_incident_workflow_request(incident_id)
        incident_workflow = incident.get('workflow')
        incident_outputs = {
            'IncidentID': incident_id,
            'WorkflowName': incident_workflow
        }
        entry_context = {f'Securonix.Incidents(val.IncidentId === obj.IncidentId)': incident_outputs}
        return f'Incident {incident_id} workflow is {incident_workflow}.', entry_context, incident


    def get_incident_available_actions(client: Client, args: Dict) -> Tuple[str, Dict, Dict]:
        """Get incident available actions.

        Args:
            client: Client object with request.
            args: Usually demisto.args()

        Returns:
            Outputs.
        """
        incident_id = str(args.get('incident_id'))

        incident_actions = client.get_incident_available_actions_request(incident_id)
        if not incident_actions:
            return f'Incident {incident_id} does not have any available actions.', {}, incident_actions
        actions = []
        for action_details in incident_actions:
            actions.append(action_details.get('actionName'))

        incident_outputs = {
            'IncidentID': incident_id,
            'AvailableActions': actions
        }
        entry_context = {f'Securonix.Incidents(val.IncidentID === obj.IncidentID)': incident_outputs}
        return f'Incident {incident_id} available actions: {actions}.', entry_context, incident_actions


    def perform_action_on_incident(client: Client, args: Dict) -> Tuple[str, Dict, Dict]:
        """Perform action on an incident.

        Args:
            client: Client object with request.
            args: Usually demisto.args()

        Returns:
            Outputs.
        """
        incident_id = str(args.get('incident_id'))
        action = str(args.get('action'))
        incident_result = client.perform_action_on_incident_request(incident_id, action)
        if incident_result != 'submitted':
            raise Exception(f'Failed to perform the action {action} on incident {incident_id}.')
        return f'Action {action} was performed on incident {incident_id}.', {}, incident_result


    def add_comment_to_incident(client: Client, args: Dict) -> Tuple[str, Dict, Dict]:
        """Add comment to an incident.

        Args:
            client: Client object with request.
            args: Usually demisto.args()

        Returns:
            Outputs.
        """
        incident_id = str(args.get('incident_id'))
        comment = str(args.get('comment'))
        incident = client.add_comment_to_incident_request(incident_id, comment)
        if not incident:
            raise Exception(f'Failed to add comment to the incident {incident_id}.')
        return f'Comment was added to the incident {incident_id} successfully.', {}, incident


    def create_incident(client: Client, args: Dict) -> Tuple[str, Dict, Dict]:
        """Create an incident.

        Args:
            client: Client object with request.
            args: Usually demisto.args()

        Returns:
            Outputs.
        """
        violation_name = str(args.get('violation_name'))
        resource_group = str(args.get('resource_group'))
        resource_name = str(args.get('resource_name'))
        entity_type = str(args.get('entity_type'))
        entity_name = str(args.get('entity_name'))
        action_name = str(args.get('action_name'))
        workflow = str(args.get('workflow')) if 'workflow' in args else None
        comment = str(args.get('comment')) if 'comment' in args else None
        criticality = str(args.get('criticality')) if 'criticality' in args else None

        if 'create incident' in action_name and not workflow:
            raise Exception(f'Creating an incident with the action: {action_name}, Supply a workflow.')
        response = client.create_incident_request(violation_name, resource_group, resource_name, entity_type, entity_name,
                                                  action_name, workflow, comment, criticality)
        result = response.get('result')
        if not result:
            raise Exception(f'Failed to create the incident.\nResponse from Securonix is: {str(response)}')

        message = response.get('messages')
        if message:
            if isinstance(message, list) and 'Invalid' in message[0]:
                message = message[0]
                raise Exception(f'Failed to create the incident with message:\n{message}')
            if 'Invalid' in message:
                raise Exception(f'Failed to create the incident with message:\n{message}')

        incident_data = result.get('data')
        incident_items = incident_data.get('incidentItems')
        incident_readable, incident_outputs = parse_data_arr(incident_items)
        headers = ['Entity', 'Incident Status', 'Incident Type', 'IncidentID', 'Priority', 'Reason', 'Url']
        human_readable = tableToMarkdown(name="Incident was created successfully", t=incident_readable,
                                         headers=headers, removeNull=True)
        entry_context = {f'Securonix.Incidents(val.IncidentID === obj.IncidentID)': incident_outputs}
        return human_readable, entry_context, response


    def list_watchlists(client: Client, *_) -> Tuple[str, Dict, Dict]:
        """List all watchlists.

        Args:
            client: Client object with request.

        Returns:
            Outputs.
        """
        watchlists = client.list_watchlist_request()
        if not watchlists:
            raise Exception(f'Failed to list watchlists.')

        human_readable = f'Watchlists: {", ".join(watchlists)}.'
        entry_context = {f'Securonix.WatchlistsNames': watchlists}
        return human_readable, entry_context, watchlists


    def get_watchlist(client: Client, args) -> Tuple[str, Dict, Dict]:
        """Get watchlist data.

        Args:
            client: Client object with request.
            args: Usually demisto.args()
        Returns:
            Outputs.
        """
        watchlist_name = args.get('watchlist_name')
        watchlist = client.get_watchlist_request(watchlist_name)

        watchlist_events = watchlist.get('events')
        if not watchlist_events:
            raise Exception(f'Watchlist does not contain items.\n'
                            f'Make sure the watchlist is not empty and that the watchlist name is correct.')
        fields_to_drop = ['decayflag', 'tenantid', 'tenantname', 'watchlistname', 'type']
        watchlist_readable, watchlist_events_outputs = parse_data_arr(watchlist_events, fields_to_drop=fields_to_drop)
        watchlist_outputs = {
            'Watchlistname': watchlist_name,
            'Type': watchlist_events[0].get('type'),
            'TenantID': watchlist_events[0].get('tenantid'),
            'TenantName': watchlist_events[0].get('tenantname'),
            'Events': watchlist_events_outputs
        }
        headers = ['Entityname', 'Fullname', 'Workemail', 'Expired']
        human_readable = tableToMarkdown(name=f"Watchlist {watchlist_name} of type {watchlist_outputs.get('Type')}:",
                                         t=watchlist_readable, headers=headers, removeNull=True)
        entry_context = {f'Securonix.Watchlists(val.Watchlistname === obj.Watchlistname)': watchlist_outputs}
        return human_readable, entry_context, watchlist


    def create_watchlist(client: Client, args) -> Tuple[str, Dict, Dict]:
        """Create a watchlist.

        Args:
            client: Client object with request.
            args: Usually demisto.args()
        Returns:
            Outputs.
        """
        watchlist_name = args.get('watchlist_name')

        response = client.create_watchlist_request(watchlist_name)

        if 'successfully' not in response:
            raise Exception(f'Failed to list watchlists.\nResponse from Securonix is:{str(response)}')
        human_readable = f'Watchlist {watchlist_name} was created successfully.'
        entry_context = {f'Securonix.Watchlists(val.Watchlistname === obj.Watchlistname)': watchlist_name}
        return human_readable, entry_context, response


    def check_entity_in_watchlist(client: Client, args) -> Tuple[str, Dict, Dict]:
        """Check if entity is in a watchlist.

        Args:
            client: Client object with request.
            args: Usually demisto.args()
        Returns:
            Outputs.
        """
        entity_name = args.get('entity_name')
        watchlist_name = args.get('watchlist_name')
        watchlist = client.check_entity_in_watchlist_request(entity_name, watchlist_name)

        result = watchlist.get('result')
        if result == 'NO' or (isinstance(result, list) and result[0] == 'NO'):
            human_readable = f'Entity unique identifier {entity_name} provided is not on the watchlist: {watchlist_name}.'
            output = {'Entityname': entity_name}
        else:  # YES
            human_readable = f'The Entity unique identifier {entity_name} provided is on the watchlist: {watchlist_name}.'
            output = {
                'Entityname': entity_name,
                'Watchlistname': watchlist_name
            }
        entry_context = {f'Securonix.EntityInWatchlist(val.Entityname === obj.Entityname)': output}
        return human_readable, entry_context, watchlist


    def add_entity_to_watchlist(client: Client, args) -> Tuple[str, Dict, Dict]:
        """Adds an entity to a watchlist.

        Args:
            client: Client object with request.
            args: Usually demisto.args()
        Returns:
            Outputs.
        """
        watchlist_name = args.get('watchlist_name')
        entity_type = args.get('entity_type')
        entity_name = args.get('entity_name')
        expiry_days = args.get('expiry_days') if 'expiry_days' in args else '30'

        response = client.add_entity_to_watchlist_request(watchlist_name, entity_type, entity_name, expiry_days)

        if 'successfull' not in response:
            raise Exception(f'Failed to add entity {entity_name} to the watchlist {watchlist_name}.\n'
                            f'Error from Securonix is: {response}.')
        human_readable = f'Added successfully the entity {entity_name} to the watchlist {watchlist_name}.'
        return human_readable, {}, response


    def fetch_incidents(client: Client, fetch_time: Optional[str], incident_types: str, last_run: Dict) -> list:
        """Uses to fetch incidents into Demisto
        Documentation: https://github.com/demisto/content/tree/master/docs/fetching_incidents

        Args:
            client: Client object with request
            fetch_time: From when to fetch if first time, e.g. `3 days`
            incident_types: Incident statuses to fetch, can be: all, open, closed
            last_run: Last fetch object.

        Returns:
            incidents, new last_run
        """
        timestamp_format = '%Y-%m-%dT%H:%M:%S.%fZ'
        now = datetime.now().strftime(timestamp_format)
        if not last_run:  # if first time running
            new_last_run = {'time': parse_date_range(fetch_time, date_format=timestamp_format)[0]}
        else:
            new_last_run = last_run

        demisto_incidents: List = list()
        from_epoch = date_to_timestamp(new_last_run.get('time'), date_format=timestamp_format)
        to_epoch = date_to_timestamp(datetime.now(), date_format=timestamp_format)
        # Get incidents from Securonix
        demisto.info(f'Fetching Securonix incidents. From: {from_epoch}. To: {to_epoch}')
        securonix_incidents = client.list_incidents_request(from_epoch, to_epoch, incident_types)

        if securonix_incidents:
            incidents_items = list(securonix_incidents.get('incidentItems'))  # type: ignore
            last_incident_id = last_run.get('id', '0')
            demisto_incidents = [{
                'name': f"Securonix Incident: {incident.get('incidentId')}",
                'occurred': timestamp_to_datestring(incident.get('lastUpdateDate')),
                'severity': incident_priority_to_dbot_score(incident.get('priority')),
                'rawJSON': json.dumps(incident)
            } for incident in incidents_items if incident.get('incidentId') > last_incident_id]
            if demisto_incidents:
                last_incident_id = incidents_items[-1].get('incidentId')
                new_last_run.update({'id': last_incident_id})

        new_last_run.update({'time': now})
        demisto.setLastRun(new_last_run)
        return demisto_incidents


    def main():
        """
        PARSE AND VALIDATE INTEGRATION PARAMS
        """
        params = demisto.params()
        host = params.get("host", None)
        tenant = params.get("tenant")
        if not host:
            server_url = tenant
            if not tenant.startswith('http://') and not tenant.startswith('https://'):
                server_url = f'https://{tenant}'
            if not tenant.endswith('.securonix.net/Snypr/ws/'):
                server_url += '.securonix.net/Snypr/ws/'
        else:
            host = host.rstrip('/')
            if not host.endswith('/ws'):
                host += '/ws/'
            server_url = host

        username = params.get('username')
        password = params.get('password')
        verify = not params.get('unsecure', False)
        proxy = demisto.params().get('proxy') is True

        command = demisto.command()
        LOG(f'Command being called in Securonix is: {command}')

        try:
            client = Client(tenant=tenant, server_url=server_url, username=username, password=password,
                            verify=verify, proxy=proxy)
            commands: Dict[str, Callable[[Client, Dict[str, str]], Tuple[str, Dict[Any, Any], Dict[Any, Any]]]] = {
                'test-module': test_module,
                'securonix-list-workflows': list_workflows,
                'securonix-get-default-assignee-for-workflow': get_default_assignee_for_workflow,
                'securonix-list-possible-threat-actions': list_possible_threat_actions,
                'securonix-list-policies': list_policies,
                'securonix-list-resource-groups': list_resource_groups,
                'securonix-list-users': list_users,
                'securonix-list-activity-data': list_activity_data,
                'securonix-list-violation-data': list_violation_data,
                'securonix-list-incidents': list_incidents,
                'securonix-get-incident': get_incident,
                'securonix-get-incident-status': get_incident_status,
                'securonix-get-incident-workflow': get_incident_workflow,
                'securonix-get-incident-available-actions': get_incident_available_actions,
                'securonix-perform-action-on-incident': perform_action_on_incident,
                'securonix-add-comment-to-incident': add_comment_to_incident,
                'securonix-create-incident': create_incident,
                'securonix-list-watchlists': list_watchlists,
                'securonix-get-watchlist': get_watchlist,
                'securonix-create-watchlist': create_watchlist,
                'securonix-check-entity-in-watchlist': check_entity_in_watchlist,
                'securonix-add-entity-to-watchlist': add_entity_to_watchlist
            }
            if command == 'fetch-incidents':
                fetch_time = params.get('fetch_time')
                incident_types = params.get('incident_types') if 'incident_types' in params else 'opened'
                incidents = fetch_incidents(client, fetch_time, incident_types, last_run=demisto.getLastRun())
                demisto.incidents(incidents)
            elif command in commands:
                return_outputs(*commands[command](client, demisto.args()))
            else:
                raise NotImplementedError(f'Command "{command}" is not implemented.')

        except Exception as err:
            return_error(str(err))


    if __name__ in ['__main__', 'builtin', 'builtins']:
        main()
  subtype: python3
  type: python
image: data:image/png;base64,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
tests:
- No test - no instance
fromversion: 4.5.0
