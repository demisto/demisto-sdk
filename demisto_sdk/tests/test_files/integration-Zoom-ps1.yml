commonfields:
  id: Zoom
  version: -1
name: Zoom
display: Zoom
category: Messaging
image: data:image/png;base64,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
description: Use the Zoom integration manage your Zoom users and meetings
detaileddescription: "detaileddescription\n\n---\n[View Integration Documentation](https://xsoar.pan.dev/docs/reference/integrations/zoom)"
configuration:
- display: ""
  name: apiKey
  defaultvalue: ""
  type: 4
  required: true
- display: ""
  name: apiSecret
  defaultvalue: ""
  type: 4
  required: true
- display: Use system proxy settings
  name: proxy
  defaultvalue: "true"
  type: 8
  required: false
script:
  script: |-
    ### pack version: 1.0.3
    $global:HOSTNAME = $demisto.Params().hostname
    $global:USERNAME = $demisto.Params().credentials.identifier
    $global:PASSWORD = $demisto.Params().credentials.password

    function CreateSession ()
    {
        <#
        .Description
        Creates a session to target machine using hostname, username and password
        #>
        $SecurePassword = ConvertTo-SecureString -AsPlainText -Force -String $global:PASSWORD
        $Creds = new-object -typename System.Management.Automation.PSCredential -argumentlist $global:USERNAME,$SecurePassword
        $Session = New-PSSession -computername $global:HOSTNAME -credential $Creds
        return $Session
    }

    function InvokeCommand ($Command)
    {
        <#
        .Description
        Runs invoke-command on existing session.
        .Example
        Get-Process powershell
        #>
        $Title = "Result for PowerShell Remote SSH Command: $Command `n"
        $Session = CreateSession
        $Result = Invoke-Command $Session -ScriptBlock { $Command }

        $EntryContext = [PSCustomObject]@{Command = $Command;Result = $Result}
        $Context = [PSCustomObject]@{
            PowerShellSSH = [PSCustomObject]@{Query=$EntryContext}
        }
        $Contents = $Title + $Result

        $DemistoResult = @{
            Type = 1;
            ContentsFormat = "json";
            Contents = $Contents;
            EntryContext = $Context;
            ReadableContentsFormat = "markdown";
            HumanReadable = $Contents
        }
        return $DemistoResult
    }

    $demisto.Info("Current command is: " + $demisto.GetCommand())

    switch -Exact ($demisto.GetCommand())
    {
        'test-module' {
            $TestConnection = InvokeCommand('$PSVersionTable')
            $demisto.Results($TestConnection); Break
        }
        'pwsh-remoting-query' {
            $Command = $demisto.Args().command
            $RunCommand = InvokeCommand($Command)
            $demisto.Results($RunCommand); Break
        }
        Default {
            $demisto.Error('Unsupported command was entered.')
        }
    }
  type: powershell
  commands:
  - name: zoom-create-user
    arguments:
    - name: first_name
      required: true
      description: First name of the new user
    - name: last_name
      required: true
      description: Last name of the new user
    - name: email
      required: true
      description: The email of the new user
    - name: user_type
      auto: PREDEFINED
      predefined:
      - Basic
      - Pro
      - Corporate
      description: The type of the newly created user
      defaultValue: Basic
    outputs:
    - contextPath: Zoom.User.id
      description: The ID of the created user
      type: string
    - contextPath: Zoom.User.first_name
      description: First name of the created user
      type: string
    - contextPath: Zoom.User.last_name
      description: Last name for the created user
      type: string
    - contextPath: Zoom.User.email
      description: Email of the created user
      type: string
    - contextPath: Zoom.User.created_at
      description: Created date of the user
      type: date
    - contextPath: Zoom.User.type
      description: The type of the user
      type: number
    description: Create a new user in zoom account
    execution: true
  - name: zoom-create-meeting
    arguments:
    - name: type
      required: true
      default: true
      auto: PREDEFINED
      predefined:
      - Instant
      - Scheduled
      description: The type of the meeting
      defaultValue: Instant
    - name: user
      required: true
      description: email address or id of user for meeting
    - name: topic
      required: true
      description: The topic of the meeting
    - name: auto-record-meeting
      auto: PREDEFINED
      predefined:
      - "yes"
      - "no"
      description: 'Record zoom meeting? '
      defaultValue: "no"
    - name: start-time
      description: Meeting start time. When using a format like “yyyy-MM-dd’T'HH:mm:ss'Z’”,
        always use GMT time. When using a format like “yyyy-MM-dd’T'HH:mm:ss”, you
        should use local time and you will need to specify the time zone. Only used
        for scheduled meetings and recurring meetings with fixed time.
    - name: timezone
      description: 'Timezone to format start_time. For example, “America/Los_Angeles”.
        For scheduled meetings only. '
    outputs:
    - contextPath: Zoom.Meeting.join_url
      description: Join url for the meeting
      type: string
    - contextPath: Zoom.Meeting.id
      description: Meeting id of the new meeting that is created
      type: string
    - contextPath: Zoom.Meeting.start_url
      description: The URL to start the meeting
      type: string
    description: Create a new zoom meeting (scheduled or instant)
  - name: zoom-fetch-recording
    arguments:
    - name: meeting_id
      required: true
      description: Meeting id to get the recording
    outputs:
    - contextPath: File.SHA256
      description: Attachment's SHA256
    - contextPath: File.SHA1
      description: Attachment's SHA1
    - contextPath: File.MD5
      description: Attachment's MD5
    - contextPath: File.Name
      description: Attachment's Name
    - contextPath: File.Info
      description: Attachment's Info
    - contextPath: File.Size
      description: Attachment's Size (In Bytes)
    - contextPath: File.Extension
      description: Attachment's Extension
    - contextPath: File.Type
      description: Attachment's Type
    - contextPath: File.EntryID
      description: Attachment's EntryID
    - contextPath: File.SSDeep
      description: Attachment's SSDeep hash
    description: Get meeting record and save as file in the warroom
  - name: zoom-list-users
    arguments:
    - name: status
      default: true
      auto: PREDEFINED
      predefined:
      - active
      - inactive
      - pending
      description: Which status of users to list
      defaultValue: active
    - name: page-size
      description: Number of users to return. Max 300.
      defaultValue: "30"
    - name: page-number
      description: Which page of results to return
      defaultValue: "1"
    outputs:
    - contextPath: Zoom.Metadata.Count
      description: Total page count available
      type: number
    - contextPath: Zoom.Metadata.Number
      description: Current page number
      type: number
    - contextPath: Zoom.Metadata.Size
      description: Number of results in current page
      type: number
    - contextPath: Zoom.Metadata.Total
      description: Total number of records
      type: number
    - contextPath: Zoom.User.id
      description: ID of the user
      type: string
    - contextPath: Zoom.User.first_name
      description: First name of user
      type: string
    - contextPath: Zoom.User.last_name
      description: Last name of user
      type: string
    - contextPath: Zoom.User.email
      description: Email of user
      type: string
    - contextPath: Zoom.User.type
      description: Type of user
      type: number
    - contextPath: Zoom.User.created_at
      description: Date when user was created
      type: date
    - contextPath: Zoom.User.dept
      description: Department for user
      type: string
    - contextPath: Zoom.User.verified
      description: Is the user verified
      type: number
    - contextPath: Zoom.User.last_login_time
      description: Last login time of the user
      type: date
    - contextPath: Zoom.User.timezone
      description: Default timezone for the user
      type: string
    - contextPath: Zoom.User.pmi
      description: PMI of user
      type: string
    - contextPath: Zoom.User.group_ids
      description: Groups user belongs to
      type: string
    description: List the existing users
  - name: zoom-delete-user
    arguments:
    - name: user
      required: true
      default: true
      description: The user ID or email to delete
    - name: action
      auto: PREDEFINED
      predefined:
      - disassociate
      - delete
      description: The action to take
      defaultValue: disassociate
    description: Delete a user from Zoom
    execution: true
  dockerimage: demisto/pyjwt:1.0
  runonce: false
